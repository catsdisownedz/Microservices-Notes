/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// node_modules/obsidian-daily-notes-interface/dist/main.js
var require_main = __commonJS({
  "node_modules/obsidian-daily-notes-interface/dist/main.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    var obsidian = require("obsidian");
    var DEFAULT_DAILY_NOTE_FORMAT = "YYYY-MM-DD";
    var DEFAULT_WEEKLY_NOTE_FORMAT = "gggg-[W]ww";
    var DEFAULT_MONTHLY_NOTE_FORMAT = "YYYY-MM";
    var DEFAULT_QUARTERLY_NOTE_FORMAT = "YYYY-[Q]Q";
    var DEFAULT_YEARLY_NOTE_FORMAT = "YYYY";
    function shouldUsePeriodicNotesSettings(periodicity) {
      var _a, _b;
      const periodicNotes = window.app.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a[periodicity]) == null ? void 0 : _b.enabled);
    }
    function getDailyNoteSettings() {
      var _a, _b, _c, _d;
      try {
        const { internalPlugins, plugins } = window.app;
        if (shouldUsePeriodicNotesSettings("daily")) {
          const { format: format2, folder: folder2, template: template2 } = ((_b = (_a = plugins.getPlugin("periodic-notes")) == null ? void 0 : _a.settings) == null ? void 0 : _b.daily) || {};
          return {
            format: format2 || DEFAULT_DAILY_NOTE_FORMAT,
            folder: (folder2 == null ? void 0 : folder2.trim()) || "",
            template: (template2 == null ? void 0 : template2.trim()) || ""
          };
        }
        const { folder, format, template } = ((_d = (_c = internalPlugins.getPluginById("daily-notes")) == null ? void 0 : _c.instance) == null ? void 0 : _d.options) || {};
        return {
          format: format || DEFAULT_DAILY_NOTE_FORMAT,
          folder: (folder == null ? void 0 : folder.trim()) || "",
          template: (template == null ? void 0 : template.trim()) || ""
        };
      } catch (err) {
        console.info("No custom daily note settings found!", err);
      }
    }
    function getWeeklyNoteSettings() {
      var _a, _b, _c, _d, _e, _f, _g;
      try {
        const pluginManager = window.app.plugins;
        const calendarSettings = (_a = pluginManager.getPlugin("calendar")) == null ? void 0 : _a.options;
        const periodicNotesSettings = (_c = (_b = pluginManager.getPlugin("periodic-notes")) == null ? void 0 : _b.settings) == null ? void 0 : _c.weekly;
        if (shouldUsePeriodicNotesSettings("weekly")) {
          return {
            format: periodicNotesSettings.format || DEFAULT_WEEKLY_NOTE_FORMAT,
            folder: ((_d = periodicNotesSettings.folder) == null ? void 0 : _d.trim()) || "",
            template: ((_e = periodicNotesSettings.template) == null ? void 0 : _e.trim()) || ""
          };
        }
        const settings = calendarSettings || {};
        return {
          format: settings.weeklyNoteFormat || DEFAULT_WEEKLY_NOTE_FORMAT,
          folder: ((_f = settings.weeklyNoteFolder) == null ? void 0 : _f.trim()) || "",
          template: ((_g = settings.weeklyNoteTemplate) == null ? void 0 : _g.trim()) || ""
        };
      } catch (err) {
        console.info("No custom weekly note settings found!", err);
      }
    }
    function getMonthlyNoteSettings() {
      var _a, _b, _c, _d;
      const pluginManager = window.app.plugins;
      try {
        const settings = shouldUsePeriodicNotesSettings("monthly") && ((_b = (_a = pluginManager.getPlugin("periodic-notes")) == null ? void 0 : _a.settings) == null ? void 0 : _b.monthly) || {};
        return {
          format: settings.format || DEFAULT_MONTHLY_NOTE_FORMAT,
          folder: ((_c = settings.folder) == null ? void 0 : _c.trim()) || "",
          template: ((_d = settings.template) == null ? void 0 : _d.trim()) || ""
        };
      } catch (err) {
        console.info("No custom monthly note settings found!", err);
      }
    }
    function getQuarterlyNoteSettings() {
      var _a, _b, _c, _d;
      const pluginManager = window.app.plugins;
      try {
        const settings = shouldUsePeriodicNotesSettings("quarterly") && ((_b = (_a = pluginManager.getPlugin("periodic-notes")) == null ? void 0 : _a.settings) == null ? void 0 : _b.quarterly) || {};
        return {
          format: settings.format || DEFAULT_QUARTERLY_NOTE_FORMAT,
          folder: ((_c = settings.folder) == null ? void 0 : _c.trim()) || "",
          template: ((_d = settings.template) == null ? void 0 : _d.trim()) || ""
        };
      } catch (err) {
        console.info("No custom quarterly note settings found!", err);
      }
    }
    function getYearlyNoteSettings() {
      var _a, _b, _c, _d;
      const pluginManager = window.app.plugins;
      try {
        const settings = shouldUsePeriodicNotesSettings("yearly") && ((_b = (_a = pluginManager.getPlugin("periodic-notes")) == null ? void 0 : _a.settings) == null ? void 0 : _b.yearly) || {};
        return {
          format: settings.format || DEFAULT_YEARLY_NOTE_FORMAT,
          folder: ((_c = settings.folder) == null ? void 0 : _c.trim()) || "",
          template: ((_d = settings.template) == null ? void 0 : _d.trim()) || ""
        };
      } catch (err) {
        console.info("No custom yearly note settings found!", err);
      }
    }
    function join(...partSegments) {
      let parts = [];
      for (let i = 0, l = partSegments.length; i < l; i++) {
        parts = parts.concat(partSegments[i].split("/"));
      }
      const newParts = [];
      for (let i = 0, l = parts.length; i < l; i++) {
        const part = parts[i];
        if (!part || part === ".")
          continue;
        else
          newParts.push(part);
      }
      if (parts[0] === "")
        newParts.unshift("");
      return newParts.join("/");
    }
    function basename(fullPath) {
      let base = fullPath.substring(fullPath.lastIndexOf("/") + 1);
      if (base.lastIndexOf(".") != -1)
        base = base.substring(0, base.lastIndexOf("."));
      return base;
    }
    async function ensureFolderExists(path) {
      const dirs = path.replace(/\\/g, "/").split("/");
      dirs.pop();
      if (dirs.length) {
        const dir = join(...dirs);
        if (!window.app.vault.getAbstractFileByPath(dir)) {
          await window.app.vault.createFolder(dir);
        }
      }
    }
    async function getNotePath(directory, filename) {
      if (!filename.endsWith(".md")) {
        filename += ".md";
      }
      const path = obsidian.normalizePath(join(directory, filename));
      await ensureFolderExists(path);
      return path;
    }
    async function getTemplateInfo(template) {
      const { metadataCache, vault } = window.app;
      const templatePath = obsidian.normalizePath(template);
      if (templatePath === "/") {
        return Promise.resolve(["", null]);
      }
      try {
        const templateFile = metadataCache.getFirstLinkpathDest(templatePath, "");
        const contents = await vault.cachedRead(templateFile);
        const IFoldInfo = window.app.foldManager.load(templateFile);
        return [contents, IFoldInfo];
      } catch (err) {
        console.error(`Failed to read the daily note template '${templatePath}'`, err);
        new obsidian.Notice("Failed to read the daily note template");
        return ["", null];
      }
    }
    function getDateUID(date, granularity = "day") {
      const ts = date.clone().startOf(granularity).format();
      return `${granularity}-${ts}`;
    }
    function removeEscapedCharacters(format) {
      return format.replace(/\[[^\]]*\]/g, "");
    }
    function isFormatAmbiguous(format, granularity) {
      if (granularity === "week") {
        const cleanFormat = removeEscapedCharacters(format);
        return /w{1,2}/i.test(cleanFormat) && (/M{1,4}/.test(cleanFormat) || /D{1,4}/.test(cleanFormat));
      }
      return false;
    }
    function getDateFromFile(file, granularity) {
      return getDateFromFilename(file.basename, granularity);
    }
    function getDateFromPath(path, granularity) {
      return getDateFromFilename(basename(path), granularity);
    }
    function getDateFromFilename(filename, granularity) {
      const getSettings = {
        day: getDailyNoteSettings,
        week: getWeeklyNoteSettings,
        month: getMonthlyNoteSettings,
        quarter: getQuarterlyNoteSettings,
        year: getYearlyNoteSettings
      };
      const format = getSettings[granularity]().format.split("/").pop();
      const noteDate = window.moment(filename, format, true);
      if (!noteDate.isValid()) {
        return null;
      }
      if (isFormatAmbiguous(format, granularity)) {
        if (granularity === "week") {
          const cleanFormat = removeEscapedCharacters(format);
          if (/w{1,2}/i.test(cleanFormat)) {
            return window.moment(
              filename,
              // If format contains week, remove day & month formatting
              format.replace(/M{1,4}/g, "").replace(/D{1,4}/g, ""),
              false
            );
          }
        }
      }
      return noteDate;
    }
    var DailyNotesFolderMissingError = class extends Error {
    };
    async function createDailyNote2(date) {
      const app2 = window.app;
      const { vault } = app2;
      const moment2 = window.moment;
      const { template, format, folder } = getDailyNoteSettings();
      const [templateContents, IFoldInfo] = await getTemplateInfo(template);
      const filename = date.format(format);
      const normalizedPath = await getNotePath(folder, filename);
      try {
        const createdFile = await vault.create(normalizedPath, templateContents.replace(/{{\s*date\s*}}/gi, filename).replace(/{{\s*time\s*}}/gi, moment2().format("HH:mm")).replace(/{{\s*title\s*}}/gi, filename).replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi, (_, _timeOrDate, calc, timeDelta, unit, momentFormat) => {
          const now = moment2();
          const currentDate = date.clone().set({
            hour: now.get("hour"),
            minute: now.get("minute"),
            second: now.get("second")
          });
          if (calc) {
            currentDate.add(parseInt(timeDelta, 10), unit);
          }
          if (momentFormat) {
            return currentDate.format(momentFormat.substring(1).trim());
          }
          return currentDate.format(format);
        }).replace(/{{\s*yesterday\s*}}/gi, date.clone().subtract(1, "day").format(format)).replace(/{{\s*tomorrow\s*}}/gi, date.clone().add(1, "d").format(format)));
        app2.foldManager.save(createdFile, IFoldInfo);
        return createdFile;
      } catch (err) {
        console.error(`Failed to create file: '${normalizedPath}'`, err);
        new obsidian.Notice("Unable to create new file.");
      }
    }
    function getDailyNote2(date, dailyNotes) {
      var _a;
      return (_a = dailyNotes[getDateUID(date, "day")]) != null ? _a : null;
    }
    function getAllDailyNotes2() {
      const { vault } = window.app;
      const { folder } = getDailyNoteSettings();
      const dailyNotesFolder = vault.getAbstractFileByPath(obsidian.normalizePath(folder));
      if (!dailyNotesFolder) {
        throw new DailyNotesFolderMissingError("Failed to find daily notes folder");
      }
      const dailyNotes = {};
      obsidian.Vault.recurseChildren(dailyNotesFolder, (note) => {
        if (note instanceof obsidian.TFile) {
          const date = getDateFromFile(note, "day");
          if (date) {
            const dateString = getDateUID(date, "day");
            dailyNotes[dateString] = note;
          }
        }
      });
      return dailyNotes;
    }
    var WeeklyNotesFolderMissingError = class extends Error {
    };
    function getDaysOfWeek() {
      const { moment: moment2 } = window;
      let weekStart = moment2.localeData()._week.dow;
      const daysOfWeek = [
        "sunday",
        "monday",
        "tuesday",
        "wednesday",
        "thursday",
        "friday",
        "saturday"
      ];
      while (weekStart) {
        daysOfWeek.push(daysOfWeek.shift());
        weekStart--;
      }
      return daysOfWeek;
    }
    function getDayOfWeekNumericalValue(dayOfWeekName) {
      return getDaysOfWeek().indexOf(dayOfWeekName.toLowerCase());
    }
    async function createWeeklyNote(date) {
      const { vault } = window.app;
      const { template, format, folder } = getWeeklyNoteSettings();
      const [templateContents, IFoldInfo] = await getTemplateInfo(template);
      const filename = date.format(format);
      const normalizedPath = await getNotePath(folder, filename);
      try {
        const createdFile = await vault.create(normalizedPath, templateContents.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi, (_, _timeOrDate, calc, timeDelta, unit, momentFormat) => {
          const now = window.moment();
          const currentDate = date.clone().set({
            hour: now.get("hour"),
            minute: now.get("minute"),
            second: now.get("second")
          });
          if (calc) {
            currentDate.add(parseInt(timeDelta, 10), unit);
          }
          if (momentFormat) {
            return currentDate.format(momentFormat.substring(1).trim());
          }
          return currentDate.format(format);
        }).replace(/{{\s*title\s*}}/gi, filename).replace(/{{\s*time\s*}}/gi, window.moment().format("HH:mm")).replace(/{{\s*(sunday|monday|tuesday|wednesday|thursday|friday|saturday)\s*:(.*?)}}/gi, (_, dayOfWeek, momentFormat) => {
          const day = getDayOfWeekNumericalValue(dayOfWeek);
          return date.weekday(day).format(momentFormat.trim());
        }));
        window.app.foldManager.save(createdFile, IFoldInfo);
        return createdFile;
      } catch (err) {
        console.error(`Failed to create file: '${normalizedPath}'`, err);
        new obsidian.Notice("Unable to create new file.");
      }
    }
    function getWeeklyNote(date, weeklyNotes) {
      var _a;
      return (_a = weeklyNotes[getDateUID(date, "week")]) != null ? _a : null;
    }
    function getAllWeeklyNotes() {
      const weeklyNotes = {};
      if (!appHasWeeklyNotesPluginLoaded()) {
        return weeklyNotes;
      }
      const { vault } = window.app;
      const { folder } = getWeeklyNoteSettings();
      const weeklyNotesFolder = vault.getAbstractFileByPath(obsidian.normalizePath(folder));
      if (!weeklyNotesFolder) {
        throw new WeeklyNotesFolderMissingError("Failed to find weekly notes folder");
      }
      obsidian.Vault.recurseChildren(weeklyNotesFolder, (note) => {
        if (note instanceof obsidian.TFile) {
          const date = getDateFromFile(note, "week");
          if (date) {
            const dateString = getDateUID(date, "week");
            weeklyNotes[dateString] = note;
          }
        }
      });
      return weeklyNotes;
    }
    var MonthlyNotesFolderMissingError = class extends Error {
    };
    async function createMonthlyNote(date) {
      const { vault } = window.app;
      const { template, format, folder } = getMonthlyNoteSettings();
      const [templateContents, IFoldInfo] = await getTemplateInfo(template);
      const filename = date.format(format);
      const normalizedPath = await getNotePath(folder, filename);
      try {
        const createdFile = await vault.create(normalizedPath, templateContents.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi, (_, _timeOrDate, calc, timeDelta, unit, momentFormat) => {
          const now = window.moment();
          const currentDate = date.clone().set({
            hour: now.get("hour"),
            minute: now.get("minute"),
            second: now.get("second")
          });
          if (calc) {
            currentDate.add(parseInt(timeDelta, 10), unit);
          }
          if (momentFormat) {
            return currentDate.format(momentFormat.substring(1).trim());
          }
          return currentDate.format(format);
        }).replace(/{{\s*date\s*}}/gi, filename).replace(/{{\s*time\s*}}/gi, window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi, filename));
        window.app.foldManager.save(createdFile, IFoldInfo);
        return createdFile;
      } catch (err) {
        console.error(`Failed to create file: '${normalizedPath}'`, err);
        new obsidian.Notice("Unable to create new file.");
      }
    }
    function getMonthlyNote(date, monthlyNotes) {
      var _a;
      return (_a = monthlyNotes[getDateUID(date, "month")]) != null ? _a : null;
    }
    function getAllMonthlyNotes() {
      const monthlyNotes = {};
      if (!appHasMonthlyNotesPluginLoaded()) {
        return monthlyNotes;
      }
      const { vault } = window.app;
      const { folder } = getMonthlyNoteSettings();
      const monthlyNotesFolder = vault.getAbstractFileByPath(obsidian.normalizePath(folder));
      if (!monthlyNotesFolder) {
        throw new MonthlyNotesFolderMissingError("Failed to find monthly notes folder");
      }
      obsidian.Vault.recurseChildren(monthlyNotesFolder, (note) => {
        if (note instanceof obsidian.TFile) {
          const date = getDateFromFile(note, "month");
          if (date) {
            const dateString = getDateUID(date, "month");
            monthlyNotes[dateString] = note;
          }
        }
      });
      return monthlyNotes;
    }
    var QuarterlyNotesFolderMissingError = class extends Error {
    };
    async function createQuarterlyNote(date) {
      const { vault } = window.app;
      const { template, format, folder } = getQuarterlyNoteSettings();
      const [templateContents, IFoldInfo] = await getTemplateInfo(template);
      const filename = date.format(format);
      const normalizedPath = await getNotePath(folder, filename);
      try {
        const createdFile = await vault.create(normalizedPath, templateContents.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi, (_, _timeOrDate, calc, timeDelta, unit, momentFormat) => {
          const now = window.moment();
          const currentDate = date.clone().set({
            hour: now.get("hour"),
            minute: now.get("minute"),
            second: now.get("second")
          });
          if (calc) {
            currentDate.add(parseInt(timeDelta, 10), unit);
          }
          if (momentFormat) {
            return currentDate.format(momentFormat.substring(1).trim());
          }
          return currentDate.format(format);
        }).replace(/{{\s*date\s*}}/gi, filename).replace(/{{\s*time\s*}}/gi, window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi, filename));
        window.app.foldManager.save(createdFile, IFoldInfo);
        return createdFile;
      } catch (err) {
        console.error(`Failed to create file: '${normalizedPath}'`, err);
        new obsidian.Notice("Unable to create new file.");
      }
    }
    function getQuarterlyNote(date, quarterly) {
      var _a;
      return (_a = quarterly[getDateUID(date, "quarter")]) != null ? _a : null;
    }
    function getAllQuarterlyNotes() {
      const quarterly = {};
      if (!appHasQuarterlyNotesPluginLoaded()) {
        return quarterly;
      }
      const { vault } = window.app;
      const { folder } = getQuarterlyNoteSettings();
      const quarterlyFolder = vault.getAbstractFileByPath(obsidian.normalizePath(folder));
      if (!quarterlyFolder) {
        throw new QuarterlyNotesFolderMissingError("Failed to find quarterly notes folder");
      }
      obsidian.Vault.recurseChildren(quarterlyFolder, (note) => {
        if (note instanceof obsidian.TFile) {
          const date = getDateFromFile(note, "quarter");
          if (date) {
            const dateString = getDateUID(date, "quarter");
            quarterly[dateString] = note;
          }
        }
      });
      return quarterly;
    }
    var YearlyNotesFolderMissingError = class extends Error {
    };
    async function createYearlyNote(date) {
      const { vault } = window.app;
      const { template, format, folder } = getYearlyNoteSettings();
      const [templateContents, IFoldInfo] = await getTemplateInfo(template);
      const filename = date.format(format);
      const normalizedPath = await getNotePath(folder, filename);
      try {
        const createdFile = await vault.create(normalizedPath, templateContents.replace(/{{\s*(date|time)\s*(([+-]\d+)([yqmwdhs]))?\s*(:.+?)?}}/gi, (_, _timeOrDate, calc, timeDelta, unit, momentFormat) => {
          const now = window.moment();
          const currentDate = date.clone().set({
            hour: now.get("hour"),
            minute: now.get("minute"),
            second: now.get("second")
          });
          if (calc) {
            currentDate.add(parseInt(timeDelta, 10), unit);
          }
          if (momentFormat) {
            return currentDate.format(momentFormat.substring(1).trim());
          }
          return currentDate.format(format);
        }).replace(/{{\s*date\s*}}/gi, filename).replace(/{{\s*time\s*}}/gi, window.moment().format("HH:mm")).replace(/{{\s*title\s*}}/gi, filename));
        window.app.foldManager.save(createdFile, IFoldInfo);
        return createdFile;
      } catch (err) {
        console.error(`Failed to create file: '${normalizedPath}'`, err);
        new obsidian.Notice("Unable to create new file.");
      }
    }
    function getYearlyNote(date, yearlyNotes) {
      var _a;
      return (_a = yearlyNotes[getDateUID(date, "year")]) != null ? _a : null;
    }
    function getAllYearlyNotes() {
      const yearlyNotes = {};
      if (!appHasYearlyNotesPluginLoaded()) {
        return yearlyNotes;
      }
      const { vault } = window.app;
      const { folder } = getYearlyNoteSettings();
      const yearlyNotesFolder = vault.getAbstractFileByPath(obsidian.normalizePath(folder));
      if (!yearlyNotesFolder) {
        throw new YearlyNotesFolderMissingError("Failed to find yearly notes folder");
      }
      obsidian.Vault.recurseChildren(yearlyNotesFolder, (note) => {
        if (note instanceof obsidian.TFile) {
          const date = getDateFromFile(note, "year");
          if (date) {
            const dateString = getDateUID(date, "year");
            yearlyNotes[dateString] = note;
          }
        }
      });
      return yearlyNotes;
    }
    function appHasDailyNotesPluginLoaded2() {
      var _a, _b;
      const { app: app2 } = window;
      const dailyNotesPlugin = app2.internalPlugins.plugins["daily-notes"];
      if (dailyNotesPlugin && dailyNotesPlugin.enabled) {
        return true;
      }
      const periodicNotes = app2.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a.daily) == null ? void 0 : _b.enabled);
    }
    function appHasWeeklyNotesPluginLoaded() {
      var _a, _b;
      const { app: app2 } = window;
      if (app2.plugins.getPlugin("calendar")) {
        return true;
      }
      const periodicNotes = app2.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a.weekly) == null ? void 0 : _b.enabled);
    }
    function appHasMonthlyNotesPluginLoaded() {
      var _a, _b;
      const { app: app2 } = window;
      const periodicNotes = app2.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a.monthly) == null ? void 0 : _b.enabled);
    }
    function appHasQuarterlyNotesPluginLoaded() {
      var _a, _b;
      const { app: app2 } = window;
      const periodicNotes = app2.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a.quarterly) == null ? void 0 : _b.enabled);
    }
    function appHasYearlyNotesPluginLoaded() {
      var _a, _b;
      const { app: app2 } = window;
      const periodicNotes = app2.plugins.getPlugin("periodic-notes");
      return periodicNotes && ((_b = (_a = periodicNotes.settings) == null ? void 0 : _a.yearly) == null ? void 0 : _b.enabled);
    }
    function getPeriodicNoteSettings(granularity) {
      const getSettings = {
        day: getDailyNoteSettings,
        week: getWeeklyNoteSettings,
        month: getMonthlyNoteSettings,
        quarter: getQuarterlyNoteSettings,
        year: getYearlyNoteSettings
      }[granularity];
      return getSettings();
    }
    function createPeriodicNote(granularity, date) {
      const createFn = {
        day: createDailyNote2,
        month: createMonthlyNote,
        week: createWeeklyNote
      };
      return createFn[granularity](date);
    }
    exports.DEFAULT_DAILY_NOTE_FORMAT = DEFAULT_DAILY_NOTE_FORMAT;
    exports.DEFAULT_MONTHLY_NOTE_FORMAT = DEFAULT_MONTHLY_NOTE_FORMAT;
    exports.DEFAULT_QUARTERLY_NOTE_FORMAT = DEFAULT_QUARTERLY_NOTE_FORMAT;
    exports.DEFAULT_WEEKLY_NOTE_FORMAT = DEFAULT_WEEKLY_NOTE_FORMAT;
    exports.DEFAULT_YEARLY_NOTE_FORMAT = DEFAULT_YEARLY_NOTE_FORMAT;
    exports.appHasDailyNotesPluginLoaded = appHasDailyNotesPluginLoaded2;
    exports.appHasMonthlyNotesPluginLoaded = appHasMonthlyNotesPluginLoaded;
    exports.appHasQuarterlyNotesPluginLoaded = appHasQuarterlyNotesPluginLoaded;
    exports.appHasWeeklyNotesPluginLoaded = appHasWeeklyNotesPluginLoaded;
    exports.appHasYearlyNotesPluginLoaded = appHasYearlyNotesPluginLoaded;
    exports.createDailyNote = createDailyNote2;
    exports.createMonthlyNote = createMonthlyNote;
    exports.createPeriodicNote = createPeriodicNote;
    exports.createQuarterlyNote = createQuarterlyNote;
    exports.createWeeklyNote = createWeeklyNote;
    exports.createYearlyNote = createYearlyNote;
    exports.getAllDailyNotes = getAllDailyNotes2;
    exports.getAllMonthlyNotes = getAllMonthlyNotes;
    exports.getAllQuarterlyNotes = getAllQuarterlyNotes;
    exports.getAllWeeklyNotes = getAllWeeklyNotes;
    exports.getAllYearlyNotes = getAllYearlyNotes;
    exports.getDailyNote = getDailyNote2;
    exports.getDailyNoteSettings = getDailyNoteSettings;
    exports.getDateFromFile = getDateFromFile;
    exports.getDateFromPath = getDateFromPath;
    exports.getDateUID = getDateUID;
    exports.getMonthlyNote = getMonthlyNote;
    exports.getMonthlyNoteSettings = getMonthlyNoteSettings;
    exports.getPeriodicNoteSettings = getPeriodicNoteSettings;
    exports.getQuarterlyNote = getQuarterlyNote;
    exports.getQuarterlyNoteSettings = getQuarterlyNoteSettings;
    exports.getTemplateInfo = getTemplateInfo;
    exports.getWeeklyNote = getWeeklyNote;
    exports.getWeeklyNoteSettings = getWeeklyNoteSettings;
    exports.getYearlyNote = getYearlyNote;
    exports.getYearlyNoteSettings = getYearlyNoteSettings;
  }
});

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => ObsidianRewarder,
  displayModal: () => displayModal,
  getDailyNoteFile: () => getDailyNoteFile
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");
var import_obsidian_daily_notes_interface = __toESM(require_main());
var import_obsidian_daily_notes_interface2 = __toESM(require_main());

// node_modules/monkey-around/mjs/index.js
function around(obj, factories) {
  const removers = Object.keys(factories).map((key) => around1(obj, key, factories[key]));
  return removers.length === 1 ? removers[0] : function() {
    removers.forEach((r) => r());
  };
}
function around1(obj, method, createWrapper) {
  const original = obj[method], hadOwn = obj.hasOwnProperty(method);
  let current = createWrapper(original);
  if (original)
    Object.setPrototypeOf(current, original);
  Object.setPrototypeOf(wrapper, current);
  obj[method] = wrapper;
  return remove;
  function wrapper(...args) {
    if (current === original && obj[method] === wrapper)
      remove();
    return current.apply(this, args);
  }
  function remove() {
    if (obj[method] === wrapper) {
      if (hadOwn)
        obj[method] = original;
      else
        delete obj[method];
    }
    if (current === original)
      return;
    current = original;
    Object.setPrototypeOf(wrapper, original || Function);
  }
}

// settings.ts
var import_obsidian = require("obsidian");
var DEFAULT_SETTINGS = {
  completedTaskCharacter: "\u2611\uFE0F",
  escapeCharacterBegin: "{",
  escapeCharacterEnd: "}",
  occurrenceTypes: [
    { label: "common", value: 20 },
    { label: "rare", value: 5 },
    { label: "legendary", value: 0.5 }
  ],
  rewardsFile: "Rewards.md",
  saveRewardToDaily: false,
  saveRewardSectionHeading: void 0,
  saveTaskToDaily: false,
  saveTaskSectionHeading: void 0,
  showModal: true,
  useAsInspirational: false
};
var ObsidianRewarderSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  sanitiseNote(value) {
    if (value === null || value.match(/^\s*$/) !== null) {
      return null;
    }
    return (0, import_obsidian.normalizePath)(value);
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h1", { text: "Functionality settings" });
    new import_obsidian.Setting(this.containerEl).setName("File with Rewards").setDesc('For example "Rewards.md" or "Folder/Rewards.md"').addText((text) => {
      text.setPlaceholder(DEFAULT_SETTINGS.rewardsFile).setValue(
        this.plugin.settings.rewardsFile.length > 0 ? this.plugin.settings.rewardsFile : ""
      ).onChange(async (value) => {
        this.plugin.settings.rewardsFile = this.sanitiseNote(value) || DEFAULT_SETTINGS.rewardsFile;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(this.containerEl).setName("Show popup when reward is awarded").setDesc("If disabled a less prominent notice will be shown instead").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.showModal);
      toggle.onChange(async (value) => {
        this.plugin.settings.showModal = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(this.containerEl).setName("Save rewards in daily note").setDesc("Will save rewards received to the end of the daily note or section heading specified below").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.saveRewardToDaily);
      toggle.onChange(async (value) => {
        this.plugin.settings.saveRewardToDaily = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("The section heading of daily note used to save rewards").setDesc(
      "This section heading is used as the place for saving rewards received in the daily note"
    ).addText(
      (text) => text.setPlaceholder("## Rewards").setValue(
        this.plugin.settings.saveRewardSectionHeading ? this.plugin.settings.saveRewardSectionHeading : ""
      ).onChange(async (value) => {
        if (value.length > 0 && value.match(/^#+/)) {
          this.plugin.settings.saveRewardSectionHeading = value;
          await this.plugin.saveSettings();
        }
      })
    ).addExtraButton(
      (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
        this.plugin.settings.saveRewardSectionHeading = DEFAULT_SETTINGS.saveRewardSectionHeading;
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian.Setting(this.containerEl).setName("Save task in daily note").setDesc("Will save completed tasks to the end of the daily note or section heading specified below").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.saveTaskToDaily);
      toggle.onChange(async (value) => {
        this.plugin.settings.saveTaskToDaily = value;
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("The section heading of daily note used to save tasks").setDesc(
      "This section heading is used as the place for saving the completed tasks in the daily note"
    ).addText(
      (text) => text.setPlaceholder("## CompletedTasks").setValue(
        this.plugin.settings.saveTaskSectionHeading ? this.plugin.settings.saveTaskSectionHeading : ""
      ).onChange(async (value) => {
        if (value.length > 0 && value.match(/^#+/)) {
          this.plugin.settings.saveTaskSectionHeading = value;
          await this.plugin.saveSettings();
        }
      })
    ).addExtraButton(
      (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
        this.plugin.settings.saveTaskSectionHeading = DEFAULT_SETTINGS.saveTaskSectionHeading;
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian.Setting(this.containerEl).setName("Use with quotes instead of rewards").setDesc(
      "Rewards are shown as inspirational quotes instead of congratulations"
    ).addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.useAsInspirational);
      toggle.onChange(async (value) => {
        this.plugin.settings.useAsInspirational = value;
        await this.plugin.saveSettings();
      });
    });
    containerEl.createEl("h1", { text: "Reward settings" });
    containerEl.createEl("h3", {
      text: "Occurrence values"
    });
    for (let i = 0; i < Object.keys(this.plugin.settings.occurrenceTypes).length; i++) {
      new import_obsidian.Setting(containerEl).setName(
        "How often should " + this.plugin.settings.occurrenceTypes[i].label + " rewards occur?"
      ).setDesc(
        "Between 0.1% to 100% for every finished task" + (i === 0 ? ". This is the default value for rewards" : "")
      ).addText((text) => {
        text.inputEl.type = "number";
        text.setPlaceholder(this.plugin.settings.occurrenceTypes[i].value).setValue(this.plugin.settings.occurrenceTypes[i].value.toString()).onChange(async (text2) => {
          if (text2.length > 0) {
            let value = parseFloat(text2);
            let refreshDisplay = false;
            if (value > 100) {
              value = 100;
              refreshDisplay = true;
            } else if (value < 0.1) {
              value = 0.1;
              refreshDisplay = true;
            }
            this.plugin.settings.occurrenceTypes[i].value = Number(value);
            await this.plugin.saveSettings();
            if (refreshDisplay) {
              this.display();
            }
          }
        });
      }).addExtraButton(
        (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
          this.plugin.settings.occurrenceTypes[i].value = DEFAULT_SETTINGS.occurrenceTypes[i].value;
          await this.plugin.saveSettings();
          this.display();
        })
      );
    }
    containerEl.createEl("h3", {
      text: "Occurence labels"
    });
    for (let i = 0; i < Object.keys(this.plugin.settings.occurrenceTypes).length; i++) {
      new import_obsidian.Setting(containerEl).setName(
        'Would you like to rename "' + this.plugin.settings.occurrenceTypes[i].label + '"?'
      ).addText((text) => {
        text.inputEl.type = "text";
        text.setPlaceholder(this.plugin.settings.occurrenceTypes[i].label).setValue(this.plugin.settings.occurrenceTypes[i].label).onChange(async (value) => {
          if (value.length > 0) {
            this.plugin.settings.occurrenceTypes[i].label = value;
            await this.plugin.saveSettings();
          }
        });
      }).addExtraButton(
        (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
          this.plugin.settings.occurrenceTypes[i].label = DEFAULT_SETTINGS.occurrenceTypes[i].label;
          await this.plugin.saveSettings();
          this.display();
        })
      );
    }
    containerEl.createEl("h3", {
      text: "Special characters"
    });
    new import_obsidian.Setting(containerEl).setName("Completed task").setDesc(
      "This character is used as prefix for completed tasks in the daily note"
    ).addText(
      (text) => text.setPlaceholder("{").setValue(this.plugin.settings.completedTaskCharacter).onChange(async (value) => {
        if (value.length > 0) {
          this.plugin.settings.completedTaskCharacter = value;
          await this.plugin.saveSettings();
        }
      })
    ).addExtraButton(
      (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
        this.plugin.settings.completedTaskCharacter = DEFAULT_SETTINGS.completedTaskCharacter;
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Start of metadata").setDesc("This character shows the start of the reward's data").addText(
      (text) => text.setPlaceholder("{").setValue(this.plugin.settings.escapeCharacterBegin).onChange(async (value) => {
        if (value.length > 0) {
          this.plugin.settings.escapeCharacterBegin = value;
          await this.plugin.saveSettings();
        }
      })
    ).addExtraButton(
      (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
        this.plugin.settings.escapeCharacterBegin = DEFAULT_SETTINGS.escapeCharacterBegin;
        await this.plugin.saveSettings();
        this.display();
      })
    );
    new import_obsidian.Setting(containerEl).setName("End of metadata").setDesc("This character shows the end of the reward's data").addText((text) => {
      text.setPlaceholder("}").setValue(this.plugin.settings.escapeCharacterEnd).onChange(async (value) => {
        if (value.length > 0) {
          this.plugin.settings.escapeCharacterEnd = value;
          await this.plugin.saveSettings();
        }
      });
    }).addExtraButton(
      (button) => button.setIcon("reset").setTooltip("Restore default").onClick(async () => {
        this.plugin.settings.escapeCharacterEnd = DEFAULT_SETTINGS.escapeCharacterEnd;
        await this.plugin.saveSettings();
        this.display();
      })
    );
  }
};

// main.ts
async function getDailyNoteFile() {
  const file = (0, import_obsidian_daily_notes_interface2.getDailyNote)((0, import_obsidian2.moment)(), (0, import_obsidian_daily_notes_interface2.getAllDailyNotes)());
  if (!file) {
    return await (0, import_obsidian_daily_notes_interface2.createDailyNote)((0, import_obsidian2.moment)());
  }
  return file;
}
var ObsidianRewarder = class extends import_obsidian2.Plugin {
  async handleReward(clickedTaskText) {
    let arrayOfCleanedRewards = [];
    let chosenReward;
    let rewardsByOccurrence = {};
    const { vault } = this.app;
    const rewardsFile = vault.getAbstractFileByPath(this.settings.rewardsFile);
    if (rewardsFile === null || !(rewardsFile instanceof import_obsidian2.TFile)) {
      new import_obsidian2.Notice(
        "Obsidian Rewards couldn't open the rewards file.\nPlease check the path in the settings."
      );
      return;
    }
    let contents;
    try {
      contents = await this.app.vault.read(rewardsFile);
    } catch (e) {
      new import_obsidian2.Notice(
        "Obsidian Rewards couldn't open the rewards file.\nPlease check the path in the settings."
      );
      return;
    }
    var char = "\n";
    let x = 0;
    let y = 0;
    let dirtyRewards = [];
    while ((y = contents.indexOf(char, x)) !== -1) {
      dirtyRewards.push(contents.substring(x, y));
      x = y + 1;
    }
    dirtyRewards.push(contents.substring(x));
    for (let i = 0; i < dirtyRewards.length; i++) {
      const dirtyReward = dirtyRewards[i];
      let rewardsLeft = 1;
      let occurrence = this.settings.occurrenceTypes[0].label;
      let rewardName = "";
      let imageLink = "";
      let metadataValues = [];
      let metadataStart = [];
      let metadataEnd = [];
      let dirtyRewardWithPartialMetadataStripped = dirtyReward;
      for (let i2 = 0; i2 < 4; i2++) {
        metadataStart[i2] = dirtyRewardWithPartialMetadataStripped.indexOf(
          this.settings.escapeCharacterBegin
        );
        metadataEnd[i2] = dirtyRewardWithPartialMetadataStripped.indexOf(
          this.settings.escapeCharacterEnd,
          metadataStart[i2]
        );
        if (metadataStart[i2] < 0) {
          rewardName = dirtyRewardWithPartialMetadataStripped;
          break;
        } else {
          metadataValues[i2] = dirtyRewardWithPartialMetadataStripped.substring(
            metadataStart[i2] + 1,
            metadataEnd[i2]
          );
        }
        if (metadataValues[i2].substring(0, 6) === "app://" || metadataValues[i2].substring(0, 4) === "http") {
          imageLink = metadataValues[i2];
        } else if (/^\d+$/.test(metadataValues[i2])) {
          rewardsLeft = parseInt(metadataValues[i2]);
        } else {
          occurrence = metadataValues[i2];
        }
        dirtyRewardWithPartialMetadataStripped = dirtyRewardWithPartialMetadataStripped.replace(
          this.settings.escapeCharacterBegin + metadataValues[i2] + this.settings.escapeCharacterEnd,
          ""
        );
      }
      const rewardObject = {
        dirtyReward: dirtyRewards[i],
        rewardName: rewardName.replace(/\n|\t|\r|- |\* |\+ /g, "").trim(),
        rewardsLeft,
        occurrence,
        imageLink
      };
      if (rewardObject.rewardsLeft > 0) {
        arrayOfCleanedRewards.push(rewardObject);
        if (rewardsByOccurrence.hasOwnProperty(occurrence)) {
          rewardsByOccurrence[occurrence].push(rewardObject);
        } else {
          rewardsByOccurrence[occurrence] = [];
          rewardsByOccurrence[occurrence].push(rewardObject);
        }
      }
    }
    let foundOccurenceTypes = {
      [this.settings.occurrenceTypes[0].label]: 0,
      [this.settings.occurrenceTypes[1].label]: 0,
      [this.settings.occurrenceTypes[2].label]: 0
    };
    for (let i = 0; i < arrayOfCleanedRewards.length; i++) {
      foundOccurenceTypes[arrayOfCleanedRewards[i].occurrence] = foundOccurenceTypes[arrayOfCleanedRewards[i].occurrence] + 1;
    }
    let sumOfOccurrences = 0;
    for (let i = 0; i < this.settings.occurrenceTypes.length; i++) {
      if (foundOccurenceTypes[this.settings.occurrenceTypes[i].label] > 0) {
        sumOfOccurrences += this.settings.occurrenceTypes[i].value;
      }
    }
    if (sumOfOccurrences > 100) {
      const divideByThisToGetTo100 = sumOfOccurrences / 100;
      for (let i = 0; i < Object.keys(this.settings.occurrenceTypes).length; i++) {
        this.settings.occurrenceTypes[i].value = this.settings.occurrenceTypes[i].value / divideByThisToGetTo100;
      }
      sumOfOccurrences = this.settings.occurrenceTypes.reduce(
        (partialSum, a) => partialSum + a,
        0
      );
    }
    sumOfOccurrences = sumOfOccurrences * 10;
    const lotteryNumber = Math.floor(Math.random() * 1e3);
    if (lotteryNumber > sumOfOccurrences) {
      this.logToDailyNote(clickedTaskText, {}, true);
      return;
    }
    const objectOfOccurrences = {};
    for (let i = 0; i < this.settings.occurrenceTypes.length; i++) {
      objectOfOccurrences[this.settings.occurrenceTypes[i].label] = this.settings.occurrenceTypes[i].value;
    }
    const arrayOfOccurrences = Object.keys(foundOccurenceTypes);
    let checkedProbabilities = 0;
    for (let i = 0; i < arrayOfOccurrences.length; i++) {
      if (foundOccurenceTypes[arrayOfOccurrences[i]] > 0 && lotteryNumber < objectOfOccurrences[arrayOfOccurrences[i]] * 10 + checkedProbabilities) {
        const randomNumberToChooseRewardWithinOccurence = Math.floor(
          Math.random() * foundOccurenceTypes[arrayOfOccurrences[i]]
        );
        chosenReward = rewardsByOccurrence[arrayOfOccurrences[i]][randomNumberToChooseRewardWithinOccurence];
        break;
      }
      checkedProbabilities = checkedProbabilities + objectOfOccurrences[arrayOfOccurrences[i]] * 10;
    }
    let modifier;
    if (this.settings.showModal) {
      modifier = await displayModal(this.app, chosenReward, this.settings);
    } else {
      const stringToShow = this.settings.useAsInspirational ? chosenReward.rewardName : "\u{1F388} \u{1F389} \u{1F388} Congratulations! \u{1F388} \u{1F389} \u{1F388}\nBy completing this task you won this reward:\n \u2B50 " + chosenReward.rewardName + " \u2B50";
      new import_obsidian2.Notice(stringToShow);
    }
    let adjustedReward;
    if (chosenReward.rewardsLeft) {
      let newRewardsLeft = parseInt(chosenReward.rewardsLeft) + parseInt(modifier);
      adjustedReward = chosenReward.dirtyReward.replace(
        this.settings.escapeCharacterBegin + chosenReward.rewardsLeft + this.settings.escapeCharacterEnd,
        this.settings.escapeCharacterBegin + newRewardsLeft + this.settings.escapeCharacterEnd
      );
    } else {
      adjustedReward = chosenReward.dirtyReward;
    }
    let newContents = contents.replace(
      chosenReward.dirtyReward,
      adjustedReward
    );
    try {
      vault.modify(rewardsFile, newContents);
    } catch (e) {
      new import_obsidian2.Notice("Obsidian Rewards couldn't modify the rewards file.");
    }
    this.logToDailyNote(clickedTaskText, chosenReward, false);
  }
  async logToDailyNote(clickedTaskText, chosenReward, logTaskOnly) {
    let logTasksText = this.settings.saveTaskToDaily ? this.settings.completedTaskCharacter + clickedTaskText + " ([[" + this.app.workspace.getActiveFile().basename + "]]) - " + (0, import_obsidian2.moment)().format("HH:mm") : "";
    let logRewardsText = this.settings.saveRewardToDaily && logTaskOnly === false ? "Earned reward: " + chosenReward.rewardName : "";
    if ((this.settings.saveRewardToDaily === true || this.settings.saveTaskToDaily === true) && (0, import_obsidian_daily_notes_interface.appHasDailyNotesPluginLoaded)() === true) {
      let file = (await getDailyNoteFile()).path;
      let existingContent = await this.app.vault.adapter.read(file);
      if (existingContent.length > 0) {
        if (this.settings.saveTaskToDaily) {
          const saveTaskSectionHeading = this.settings.saveTaskSectionHeading;
          if (saveTaskSectionHeading) {
            const matches = existingContent.match(new RegExp("(?:^|\n)" + saveTaskSectionHeading + "[^\n]*\n.*?(?=\n*##?s?|$)", "gs"));
            if (matches && matches.length > 0) {
              const match = matches[0];
              existingContent = existingContent.replace(match, match + "\n" + logTasksText);
            } else {
              existingContent = existingContent + "\n" + logTasksText;
            }
          } else {
            existingContent = existingContent + "\n" + logTasksText;
          }
        }
        if (this.settings.saveRewardToDaily && logTaskOnly === false) {
          const saveRewardSectionHeading = this.settings.saveRewardSectionHeading;
          if (saveRewardSectionHeading) {
            const matches = existingContent.match(new RegExp("(?:^|\n)" + saveRewardSectionHeading + "[^\n]*\n.*?(?=\n*##?s?|$)", "gs"));
            if (matches && matches.length > 0) {
              const match = matches[0];
              existingContent = existingContent.replace(match, match + "\n" + logRewardsText);
            } else {
              existingContent = existingContent + "\n" + logRewardsText;
            }
          } else {
            existingContent = existingContent + "\n" + logRewardsText;
          }
        }
      }
      await this.app.vault.adapter.write(file, existingContent);
    }
  }
  async createSampleNote(self) {
    let folder = app.fileManager.getNewFileParent("");
    const createdNote = await app.fileManager.createNewMarkdownFile(
      folder,
      "Rewards.md"
    );
    const sampleContentsForNote = "- Have a cup of tea\n- Watch an episode of favourite series " + self.settings.escapeCharacterBegin + self.settings.occurrenceTypes[1].label + self.settings.escapeCharacterEnd + " " + self.settings.escapeCharacterBegin + "20" + self.settings.escapeCharacterEnd + "\n- Knit for 15 minutes " + self.settings.escapeCharacterBegin + self.settings.occurrenceTypes[1].label + self.settings.escapeCharacterEnd + " \n- Open the birthday present champagne bottle " + self.settings.escapeCharacterBegin + self.settings.occurrenceTypes[2].label + self.settings.escapeCharacterEnd + " " + self.settings.escapeCharacterBegin + "1" + self.settings.escapeCharacterEnd;
    app.vault.modify(createdNote, sampleContentsForNote);
    new import_obsidian2.Notice("Created file " + createdNote.path);
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new ObsidianRewarderSettingsTab(this.app, this));
    this.addCommand({
      id: "create-sample-rewards-note",
      name: "Create sample rewards note",
      callback: () => {
        this.createSampleNote(this);
      }
    });
    let callback = (evt) => {
      if (evt.target instanceof HTMLInputElement && evt.target.type === "checkbox" && evt.target.checked && (evt.target.parentNode.innerText.length > 0 || evt.target.parentNode.parentNode.innerText.length > 0)) {
        evt.target.parentNode.innerText.length > 0 ? this.handleReward(evt.target.parentNode.innerText) : this.handleReward(evt.target.parentNode.parentNode.innerText);
      }
    };
    window.addEventListener("click", callback, { capture: true });
    this.register(
      () => window.removeEventListener("click", callback, { capture: true })
    );
    if (this.app.workspace.layoutReady) {
      this.onLayoutReady();
    } else {
      this.app.workspace.on("layout-ready", this.onLayoutReady.bind(this));
    }
  }
  onLayoutReady() {
    const toggleCheckboxStatusCommand = this.app.commands.findCommand("editor:toggle-checklist-status");
    const that = this;
    around(toggleCheckboxStatusCommand, {
      editorCallback: (next) => function(editor) {
        next.call(this, editor);
        let cursor = editor.getCursor();
        let lineText = editor.getLine(cursor.line);
        const idx = lineText.search(/- \[x\] /);
        if (idx >= 0) {
          const checkedTaskText = lineText.substring(idx + 6);
          that.handleReward(checkedTaskText);
        }
      }
    });
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
async function displayModal(app2, rewardObject, settings) {
  return new Promise((resolve, reject) => {
    try {
      const modal = new CongratulationsModal(app2, rewardObject, settings);
      modal.onClose = () => {
        resolve(modal.modifier);
      };
      modal.open();
    } catch (e) {
      reject();
    }
  });
}
var CongratulationsModal = class extends import_obsidian2.Modal {
  constructor(app2, rewardObject, settings) {
    super(app2);
    this.rewardObject = rewardObject;
    this.settings = settings;
    this.modifier = -1;
  }
  onOpen() {
    const { contentEl, containerEl } = this;
    const modal = contentEl.createEl("div", { cls: "rewarderModal" });
    if (this.settings.useAsInspirational) {
      modal.createEl("h1", {
        text: this.rewardObject.rewardName
      });
      modal.createEl("img", {
        attr: {
          src: this.rewardObject.imageLink
        }
      });
    } else {
      modal.createEl("h2", {
        text: "Congratulations!"
      });
      modal.createEl("p", {
        text: "By completing this task you won this reward:"
      });
      modal.createEl("h1", {
        text: "\u2B50 " + this.rewardObject.rewardName + " \u2B50",
        cls: "rewardName"
      });
      modal.createEl("img", {
        attr: {
          src: this.rewardObject.imageLink
        }
      });
      modal.createEl("h2", {
        text: "\u{1F388} \u{1F389} \u{1F388}"
      });
      modal.createEl("button", {
        attr: { type: "button" },
        text: "Skip this reward"
      }).addEventListener("click", () => {
        this.modifier = 0;
        this.close();
      });
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibm9kZV9tb2R1bGVzL29ic2lkaWFuLWRhaWx5LW5vdGVzLWludGVyZmFjZS9kaXN0L21haW4uanMiLCAibWFpbi50cyIsICJub2RlX21vZHVsZXMvbW9ua2V5LWFyb3VuZC9tanMvaW5kZXguanMiLCAic2V0dGluZ3MudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcblxudmFyIG9ic2lkaWFuID0gcmVxdWlyZSgnb2JzaWRpYW4nKTtcblxuY29uc3QgREVGQVVMVF9EQUlMWV9OT1RFX0ZPUk1BVCA9IFwiWVlZWS1NTS1ERFwiO1xuY29uc3QgREVGQVVMVF9XRUVLTFlfTk9URV9GT1JNQVQgPSBcImdnZ2ctW1ddd3dcIjtcbmNvbnN0IERFRkFVTFRfTU9OVEhMWV9OT1RFX0ZPUk1BVCA9IFwiWVlZWS1NTVwiO1xuY29uc3QgREVGQVVMVF9RVUFSVEVSTFlfTk9URV9GT1JNQVQgPSBcIllZWVktW1FdUVwiO1xuY29uc3QgREVGQVVMVF9ZRUFSTFlfTk9URV9GT1JNQVQgPSBcIllZWVlcIjtcblxuZnVuY3Rpb24gc2hvdWxkVXNlUGVyaW9kaWNOb3Rlc1NldHRpbmdzKHBlcmlvZGljaXR5KSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwZXJpb2RpY05vdGVzID0gd2luZG93LmFwcC5wbHVnaW5zLmdldFBsdWdpbihcInBlcmlvZGljLW5vdGVzXCIpO1xuICAgIHJldHVybiBwZXJpb2RpY05vdGVzICYmIHBlcmlvZGljTm90ZXMuc2V0dGluZ3M/LltwZXJpb2RpY2l0eV0/LmVuYWJsZWQ7XG59XG4vKipcbiAqIFJlYWQgdGhlIHVzZXIgc2V0dGluZ3MgZm9yIHRoZSBgZGFpbHktbm90ZXNgIHBsdWdpblxuICogdG8ga2VlcCBiZWhhdmlvciBvZiBjcmVhdGluZyBhIG5ldyBub3RlIGluLXN5bmMuXG4gKi9cbmZ1bmN0aW9uIGdldERhaWx5Tm90ZVNldHRpbmdzKCkge1xuICAgIHRyeSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGNvbnN0IHsgaW50ZXJuYWxQbHVnaW5zLCBwbHVnaW5zIH0gPSB3aW5kb3cuYXBwO1xuICAgICAgICBpZiAoc2hvdWxkVXNlUGVyaW9kaWNOb3Rlc1NldHRpbmdzKFwiZGFpbHlcIikpIHtcbiAgICAgICAgICAgIGNvbnN0IHsgZm9ybWF0LCBmb2xkZXIsIHRlbXBsYXRlIH0gPSBwbHVnaW5zLmdldFBsdWdpbihcInBlcmlvZGljLW5vdGVzXCIpPy5zZXR0aW5ncz8uZGFpbHkgfHwge307XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0IHx8IERFRkFVTFRfREFJTFlfTk9URV9GT1JNQVQsXG4gICAgICAgICAgICAgICAgZm9sZGVyOiBmb2xkZXI/LnRyaW0oKSB8fCBcIlwiLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZT8udHJpbSgpIHx8IFwiXCIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHsgZm9sZGVyLCBmb3JtYXQsIHRlbXBsYXRlIH0gPSBpbnRlcm5hbFBsdWdpbnMuZ2V0UGx1Z2luQnlJZChcImRhaWx5LW5vdGVzXCIpPy5pbnN0YW5jZT8ub3B0aW9ucyB8fCB7fTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0IHx8IERFRkFVTFRfREFJTFlfTk9URV9GT1JNQVQsXG4gICAgICAgICAgICBmb2xkZXI6IGZvbGRlcj8udHJpbSgpIHx8IFwiXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogdGVtcGxhdGU/LnRyaW0oKSB8fCBcIlwiLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIk5vIGN1c3RvbSBkYWlseSBub3RlIHNldHRpbmdzIGZvdW5kIVwiLCBlcnIpO1xuICAgIH1cbn1cbi8qKlxuICogUmVhZCB0aGUgdXNlciBzZXR0aW5ncyBmb3IgdGhlIGB3ZWVrbHktbm90ZXNgIHBsdWdpblxuICogdG8ga2VlcCBiZWhhdmlvciBvZiBjcmVhdGluZyBhIG5ldyBub3RlIGluLXN5bmMuXG4gKi9cbmZ1bmN0aW9uIGdldFdlZWtseU5vdGVTZXR0aW5ncygpIHtcbiAgICB0cnkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCBwbHVnaW5NYW5hZ2VyID0gd2luZG93LmFwcC5wbHVnaW5zO1xuICAgICAgICBjb25zdCBjYWxlbmRhclNldHRpbmdzID0gcGx1Z2luTWFuYWdlci5nZXRQbHVnaW4oXCJjYWxlbmRhclwiKT8ub3B0aW9ucztcbiAgICAgICAgY29uc3QgcGVyaW9kaWNOb3Rlc1NldHRpbmdzID0gcGx1Z2luTWFuYWdlci5nZXRQbHVnaW4oXCJwZXJpb2RpYy1ub3Rlc1wiKT8uc2V0dGluZ3M/LndlZWtseTtcbiAgICAgICAgaWYgKHNob3VsZFVzZVBlcmlvZGljTm90ZXNTZXR0aW5ncyhcIndlZWtseVwiKSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IHBlcmlvZGljTm90ZXNTZXR0aW5ncy5mb3JtYXQgfHwgREVGQVVMVF9XRUVLTFlfTk9URV9GT1JNQVQsXG4gICAgICAgICAgICAgICAgZm9sZGVyOiBwZXJpb2RpY05vdGVzU2V0dGluZ3MuZm9sZGVyPy50cmltKCkgfHwgXCJcIixcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogcGVyaW9kaWNOb3Rlc1NldHRpbmdzLnRlbXBsYXRlPy50cmltKCkgfHwgXCJcIixcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBjYWxlbmRhclNldHRpbmdzIHx8IHt9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZm9ybWF0OiBzZXR0aW5ncy53ZWVrbHlOb3RlRm9ybWF0IHx8IERFRkFVTFRfV0VFS0xZX05PVEVfRk9STUFULFxuICAgICAgICAgICAgZm9sZGVyOiBzZXR0aW5ncy53ZWVrbHlOb3RlRm9sZGVyPy50cmltKCkgfHwgXCJcIixcbiAgICAgICAgICAgIHRlbXBsYXRlOiBzZXR0aW5ncy53ZWVrbHlOb3RlVGVtcGxhdGU/LnRyaW0oKSB8fCBcIlwiLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIk5vIGN1c3RvbSB3ZWVrbHkgbm90ZSBzZXR0aW5ncyBmb3VuZCFcIiwgZXJyKTtcbiAgICB9XG59XG4vKipcbiAqIFJlYWQgdGhlIHVzZXIgc2V0dGluZ3MgZm9yIHRoZSBgcGVyaW9kaWMtbm90ZXNgIHBsdWdpblxuICogdG8ga2VlcCBiZWhhdmlvciBvZiBjcmVhdGluZyBhIG5ldyBub3RlIGluLXN5bmMuXG4gKi9cbmZ1bmN0aW9uIGdldE1vbnRobHlOb3RlU2V0dGluZ3MoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwbHVnaW5NYW5hZ2VyID0gd2luZG93LmFwcC5wbHVnaW5zO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gKHNob3VsZFVzZVBlcmlvZGljTm90ZXNTZXR0aW5ncyhcIm1vbnRobHlcIikgJiZcbiAgICAgICAgICAgIHBsdWdpbk1hbmFnZXIuZ2V0UGx1Z2luKFwicGVyaW9kaWMtbm90ZXNcIik/LnNldHRpbmdzPy5tb250aGx5KSB8fFxuICAgICAgICAgICAge307XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmb3JtYXQ6IHNldHRpbmdzLmZvcm1hdCB8fCBERUZBVUxUX01PTlRITFlfTk9URV9GT1JNQVQsXG4gICAgICAgICAgICBmb2xkZXI6IHNldHRpbmdzLmZvbGRlcj8udHJpbSgpIHx8IFwiXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogc2V0dGluZ3MudGVtcGxhdGU/LnRyaW0oKSB8fCBcIlwiLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIk5vIGN1c3RvbSBtb250aGx5IG5vdGUgc2V0dGluZ3MgZm91bmQhXCIsIGVycik7XG4gICAgfVxufVxuLyoqXG4gKiBSZWFkIHRoZSB1c2VyIHNldHRpbmdzIGZvciB0aGUgYHBlcmlvZGljLW5vdGVzYCBwbHVnaW5cbiAqIHRvIGtlZXAgYmVoYXZpb3Igb2YgY3JlYXRpbmcgYSBuZXcgbm90ZSBpbi1zeW5jLlxuICovXG5mdW5jdGlvbiBnZXRRdWFydGVybHlOb3RlU2V0dGluZ3MoKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwbHVnaW5NYW5hZ2VyID0gd2luZG93LmFwcC5wbHVnaW5zO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gKHNob3VsZFVzZVBlcmlvZGljTm90ZXNTZXR0aW5ncyhcInF1YXJ0ZXJseVwiKSAmJlxuICAgICAgICAgICAgcGx1Z2luTWFuYWdlci5nZXRQbHVnaW4oXCJwZXJpb2RpYy1ub3Rlc1wiKT8uc2V0dGluZ3M/LnF1YXJ0ZXJseSkgfHxcbiAgICAgICAgICAgIHt9O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZm9ybWF0OiBzZXR0aW5ncy5mb3JtYXQgfHwgREVGQVVMVF9RVUFSVEVSTFlfTk9URV9GT1JNQVQsXG4gICAgICAgICAgICBmb2xkZXI6IHNldHRpbmdzLmZvbGRlcj8udHJpbSgpIHx8IFwiXCIsXG4gICAgICAgICAgICB0ZW1wbGF0ZTogc2V0dGluZ3MudGVtcGxhdGU/LnRyaW0oKSB8fCBcIlwiLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIk5vIGN1c3RvbSBxdWFydGVybHkgbm90ZSBzZXR0aW5ncyBmb3VuZCFcIiwgZXJyKTtcbiAgICB9XG59XG4vKipcbiAqIFJlYWQgdGhlIHVzZXIgc2V0dGluZ3MgZm9yIHRoZSBgcGVyaW9kaWMtbm90ZXNgIHBsdWdpblxuICogdG8ga2VlcCBiZWhhdmlvciBvZiBjcmVhdGluZyBhIG5ldyBub3RlIGluLXN5bmMuXG4gKi9cbmZ1bmN0aW9uIGdldFllYXJseU5vdGVTZXR0aW5ncygpIHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGNvbnN0IHBsdWdpbk1hbmFnZXIgPSB3aW5kb3cuYXBwLnBsdWdpbnM7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSAoc2hvdWxkVXNlUGVyaW9kaWNOb3Rlc1NldHRpbmdzKFwieWVhcmx5XCIpICYmXG4gICAgICAgICAgICBwbHVnaW5NYW5hZ2VyLmdldFBsdWdpbihcInBlcmlvZGljLW5vdGVzXCIpPy5zZXR0aW5ncz8ueWVhcmx5KSB8fFxuICAgICAgICAgICAge307XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmb3JtYXQ6IHNldHRpbmdzLmZvcm1hdCB8fCBERUZBVUxUX1lFQVJMWV9OT1RFX0ZPUk1BVCxcbiAgICAgICAgICAgIGZvbGRlcjogc2V0dGluZ3MuZm9sZGVyPy50cmltKCkgfHwgXCJcIixcbiAgICAgICAgICAgIHRlbXBsYXRlOiBzZXR0aW5ncy50ZW1wbGF0ZT8udHJpbSgpIHx8IFwiXCIsXG4gICAgICAgIH07XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5pbmZvKFwiTm8gY3VzdG9tIHllYXJseSBub3RlIHNldHRpbmdzIGZvdW5kIVwiLCBlcnIpO1xuICAgIH1cbn1cblxuLy8gQ3JlZGl0OiBAY3JlYXRpb25peC9wYXRoLmpzXG5mdW5jdGlvbiBqb2luKC4uLnBhcnRTZWdtZW50cykge1xuICAgIC8vIFNwbGl0IHRoZSBpbnB1dHMgaW50byBhIGxpc3Qgb2YgcGF0aCBjb21tYW5kcy5cbiAgICBsZXQgcGFydHMgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBhcnRTZWdtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgcGFydHMgPSBwYXJ0cy5jb25jYXQocGFydFNlZ21lbnRzW2ldLnNwbGl0KFwiL1wiKSk7XG4gICAgfVxuICAgIC8vIEludGVycHJldCB0aGUgcGF0aCBjb21tYW5kcyB0byBnZXQgdGhlIG5ldyByZXNvbHZlZCBwYXRoLlxuICAgIGNvbnN0IG5ld1BhcnRzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDAsIGwgPSBwYXJ0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY29uc3QgcGFydCA9IHBhcnRzW2ldO1xuICAgICAgICAvLyBSZW1vdmUgbGVhZGluZyBhbmQgdHJhaWxpbmcgc2xhc2hlc1xuICAgICAgICAvLyBBbHNvIHJlbW92ZSBcIi5cIiBzZWdtZW50c1xuICAgICAgICBpZiAoIXBhcnQgfHwgcGFydCA9PT0gXCIuXCIpXG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgLy8gUHVzaCBuZXcgcGF0aCBzZWdtZW50cy5cbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgbmV3UGFydHMucHVzaChwYXJ0KTtcbiAgICB9XG4gICAgLy8gUHJlc2VydmUgdGhlIGluaXRpYWwgc2xhc2ggaWYgdGhlcmUgd2FzIG9uZS5cbiAgICBpZiAocGFydHNbMF0gPT09IFwiXCIpXG4gICAgICAgIG5ld1BhcnRzLnVuc2hpZnQoXCJcIik7XG4gICAgLy8gVHVybiBiYWNrIGludG8gYSBzaW5nbGUgc3RyaW5nIHBhdGguXG4gICAgcmV0dXJuIG5ld1BhcnRzLmpvaW4oXCIvXCIpO1xufVxuZnVuY3Rpb24gYmFzZW5hbWUoZnVsbFBhdGgpIHtcbiAgICBsZXQgYmFzZSA9IGZ1bGxQYXRoLnN1YnN0cmluZyhmdWxsUGF0aC5sYXN0SW5kZXhPZihcIi9cIikgKyAxKTtcbiAgICBpZiAoYmFzZS5sYXN0SW5kZXhPZihcIi5cIikgIT0gLTEpXG4gICAgICAgIGJhc2UgPSBiYXNlLnN1YnN0cmluZygwLCBiYXNlLmxhc3RJbmRleE9mKFwiLlwiKSk7XG4gICAgcmV0dXJuIGJhc2U7XG59XG5hc3luYyBmdW5jdGlvbiBlbnN1cmVGb2xkZXJFeGlzdHMocGF0aCkge1xuICAgIGNvbnN0IGRpcnMgPSBwYXRoLnJlcGxhY2UoL1xcXFwvZywgXCIvXCIpLnNwbGl0KFwiL1wiKTtcbiAgICBkaXJzLnBvcCgpOyAvLyByZW1vdmUgYmFzZW5hbWVcbiAgICBpZiAoZGlycy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3QgZGlyID0gam9pbiguLi5kaXJzKTtcbiAgICAgICAgaWYgKCF3aW5kb3cuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChkaXIpKSB7XG4gICAgICAgICAgICBhd2FpdCB3aW5kb3cuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihkaXIpO1xuICAgICAgICB9XG4gICAgfVxufVxuYXN5bmMgZnVuY3Rpb24gZ2V0Tm90ZVBhdGgoZGlyZWN0b3J5LCBmaWxlbmFtZSkge1xuICAgIGlmICghZmlsZW5hbWUuZW5kc1dpdGgoXCIubWRcIikpIHtcbiAgICAgICAgZmlsZW5hbWUgKz0gXCIubWRcIjtcbiAgICB9XG4gICAgY29uc3QgcGF0aCA9IG9ic2lkaWFuLm5vcm1hbGl6ZVBhdGgoam9pbihkaXJlY3RvcnksIGZpbGVuYW1lKSk7XG4gICAgYXdhaXQgZW5zdXJlRm9sZGVyRXhpc3RzKHBhdGgpO1xuICAgIHJldHVybiBwYXRoO1xufVxuYXN5bmMgZnVuY3Rpb24gZ2V0VGVtcGxhdGVJbmZvKHRlbXBsYXRlKSB7XG4gICAgY29uc3QgeyBtZXRhZGF0YUNhY2hlLCB2YXVsdCB9ID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB0ZW1wbGF0ZVBhdGggPSBvYnNpZGlhbi5ub3JtYWxpemVQYXRoKHRlbXBsYXRlKTtcbiAgICBpZiAodGVtcGxhdGVQYXRoID09PSBcIi9cIikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtcIlwiLCBudWxsXSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHRlbXBsYXRlRmlsZSA9IG1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QodGVtcGxhdGVQYXRoLCBcIlwiKTtcbiAgICAgICAgY29uc3QgY29udGVudHMgPSBhd2FpdCB2YXVsdC5jYWNoZWRSZWFkKHRlbXBsYXRlRmlsZSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIGNvbnN0IElGb2xkSW5mbyA9IHdpbmRvdy5hcHAuZm9sZE1hbmFnZXIubG9hZCh0ZW1wbGF0ZUZpbGUpO1xuICAgICAgICByZXR1cm4gW2NvbnRlbnRzLCBJRm9sZEluZm9dO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byByZWFkIHRoZSBkYWlseSBub3RlIHRlbXBsYXRlICcke3RlbXBsYXRlUGF0aH0nYCwgZXJyKTtcbiAgICAgICAgbmV3IG9ic2lkaWFuLk5vdGljZShcIkZhaWxlZCB0byByZWFkIHRoZSBkYWlseSBub3RlIHRlbXBsYXRlXCIpO1xuICAgICAgICByZXR1cm4gW1wiXCIsIG51bGxdO1xuICAgIH1cbn1cblxuLyoqXG4gKiBkYXRlVUlEIGlzIGEgd2F5IG9mIHdlZWtseSBpZGVudGlmeWluZyBkYWlseS93ZWVrbHkvbW9udGhseSBub3Rlcy5cbiAqIFRoZXkgYXJlIHByZWZpeGVkIHdpdGggdGhlIGdyYW51bGFyaXR5IHRvIGF2b2lkIGFtYmlndWl0eS5cbiAqL1xuZnVuY3Rpb24gZ2V0RGF0ZVVJRChkYXRlLCBncmFudWxhcml0eSA9IFwiZGF5XCIpIHtcbiAgICBjb25zdCB0cyA9IGRhdGUuY2xvbmUoKS5zdGFydE9mKGdyYW51bGFyaXR5KS5mb3JtYXQoKTtcbiAgICByZXR1cm4gYCR7Z3JhbnVsYXJpdHl9LSR7dHN9YDtcbn1cbmZ1bmN0aW9uIHJlbW92ZUVzY2FwZWRDaGFyYWN0ZXJzKGZvcm1hdCkge1xuICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgvXFxbW15cXF1dKlxcXS9nLCBcIlwiKTsgLy8gcmVtb3ZlIGV2ZXJ5dGhpbmcgd2l0aGluIGJyYWNrZXRzXG59XG4vKipcbiAqIFhYWDogV2hlbiBwYXJzaW5nIGRhdGVzIHRoYXQgY29udGFpbiBib3RoIHdlZWsgbnVtYmVycyBhbmQgbW9udGhzLFxuICogTW9tZW50IGNob3NlcyB0byBpZ25vcmUgdGhlIHdlZWsgbnVtYmVycy4gRm9yIHRoZSB3ZWVrIGRhdGVVSUQsIHdlXG4gKiB3YW50IHRoZSBvcHBvc2l0ZSBiZWhhdmlvci4gU3RyaXAgdGhlIE1NTSBmcm9tIHRoZSBmb3JtYXQgdG8gcGF0Y2guXG4gKi9cbmZ1bmN0aW9uIGlzRm9ybWF0QW1iaWd1b3VzKGZvcm1hdCwgZ3JhbnVsYXJpdHkpIHtcbiAgICBpZiAoZ3JhbnVsYXJpdHkgPT09IFwid2Vla1wiKSB7XG4gICAgICAgIGNvbnN0IGNsZWFuRm9ybWF0ID0gcmVtb3ZlRXNjYXBlZENoYXJhY3RlcnMoZm9ybWF0KTtcbiAgICAgICAgcmV0dXJuICgvd3sxLDJ9L2kudGVzdChjbGVhbkZvcm1hdCkgJiZcbiAgICAgICAgICAgICgvTXsxLDR9Ly50ZXN0KGNsZWFuRm9ybWF0KSB8fCAvRHsxLDR9Ly50ZXN0KGNsZWFuRm9ybWF0KSkpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5mdW5jdGlvbiBnZXREYXRlRnJvbUZpbGUoZmlsZSwgZ3JhbnVsYXJpdHkpIHtcbiAgICByZXR1cm4gZ2V0RGF0ZUZyb21GaWxlbmFtZShmaWxlLmJhc2VuYW1lLCBncmFudWxhcml0eSk7XG59XG5mdW5jdGlvbiBnZXREYXRlRnJvbVBhdGgocGF0aCwgZ3JhbnVsYXJpdHkpIHtcbiAgICByZXR1cm4gZ2V0RGF0ZUZyb21GaWxlbmFtZShiYXNlbmFtZShwYXRoKSwgZ3JhbnVsYXJpdHkpO1xufVxuZnVuY3Rpb24gZ2V0RGF0ZUZyb21GaWxlbmFtZShmaWxlbmFtZSwgZ3JhbnVsYXJpdHkpIHtcbiAgICBjb25zdCBnZXRTZXR0aW5ncyA9IHtcbiAgICAgICAgZGF5OiBnZXREYWlseU5vdGVTZXR0aW5ncyxcbiAgICAgICAgd2VlazogZ2V0V2Vla2x5Tm90ZVNldHRpbmdzLFxuICAgICAgICBtb250aDogZ2V0TW9udGhseU5vdGVTZXR0aW5ncyxcbiAgICAgICAgcXVhcnRlcjogZ2V0UXVhcnRlcmx5Tm90ZVNldHRpbmdzLFxuICAgICAgICB5ZWFyOiBnZXRZZWFybHlOb3RlU2V0dGluZ3MsXG4gICAgfTtcbiAgICBjb25zdCBmb3JtYXQgPSBnZXRTZXR0aW5nc1tncmFudWxhcml0eV0oKS5mb3JtYXQuc3BsaXQoXCIvXCIpLnBvcCgpO1xuICAgIGNvbnN0IG5vdGVEYXRlID0gd2luZG93Lm1vbWVudChmaWxlbmFtZSwgZm9ybWF0LCB0cnVlKTtcbiAgICBpZiAoIW5vdGVEYXRlLmlzVmFsaWQoKSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKGlzRm9ybWF0QW1iaWd1b3VzKGZvcm1hdCwgZ3JhbnVsYXJpdHkpKSB7XG4gICAgICAgIGlmIChncmFudWxhcml0eSA9PT0gXCJ3ZWVrXCIpIHtcbiAgICAgICAgICAgIGNvbnN0IGNsZWFuRm9ybWF0ID0gcmVtb3ZlRXNjYXBlZENoYXJhY3RlcnMoZm9ybWF0KTtcbiAgICAgICAgICAgIGlmICgvd3sxLDJ9L2kudGVzdChjbGVhbkZvcm1hdCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gd2luZG93Lm1vbWVudChmaWxlbmFtZSwgXG4gICAgICAgICAgICAgICAgLy8gSWYgZm9ybWF0IGNvbnRhaW5zIHdlZWssIHJlbW92ZSBkYXkgJiBtb250aCBmb3JtYXR0aW5nXG4gICAgICAgICAgICAgICAgZm9ybWF0LnJlcGxhY2UoL017MSw0fS9nLCBcIlwiKS5yZXBsYWNlKC9EezEsNH0vZywgXCJcIiksIGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm90ZURhdGU7XG59XG5cbmNsYXNzIERhaWx5Tm90ZXNGb2xkZXJNaXNzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG59XG4vKipcbiAqIFRoaXMgZnVuY3Rpb24gbWltaWNzIHRoZSBiZWhhdmlvciBvZiB0aGUgZGFpbHktbm90ZXMgcGx1Z2luXG4gKiBzbyBpdCB3aWxsIHJlcGxhY2Uge3tkYXRlfX0sIHt7dGl0bGV9fSwgYW5kIHt7dGltZX19IHdpdGggdGhlXG4gKiBmb3JtYXR0ZWQgdGltZXN0YW1wLlxuICpcbiAqIE5vdGU6IGl0IGhhcyBhbiBhZGRlZCBib251cyB0aGF0IGl0J3Mgbm90ICd0b2RheScgc3BlY2lmaWMuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZURhaWx5Tm90ZShkYXRlKSB7XG4gICAgY29uc3QgYXBwID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB7IHZhdWx0IH0gPSBhcHA7XG4gICAgY29uc3QgbW9tZW50ID0gd2luZG93Lm1vbWVudDtcbiAgICBjb25zdCB7IHRlbXBsYXRlLCBmb3JtYXQsIGZvbGRlciB9ID0gZ2V0RGFpbHlOb3RlU2V0dGluZ3MoKTtcbiAgICBjb25zdCBbdGVtcGxhdGVDb250ZW50cywgSUZvbGRJbmZvXSA9IGF3YWl0IGdldFRlbXBsYXRlSW5mbyh0ZW1wbGF0ZSk7XG4gICAgY29uc3QgZmlsZW5hbWUgPSBkYXRlLmZvcm1hdChmb3JtYXQpO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRQYXRoID0gYXdhaXQgZ2V0Tm90ZVBhdGgoZm9sZGVyLCBmaWxlbmFtZSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY3JlYXRlZEZpbGUgPSBhd2FpdCB2YXVsdC5jcmVhdGUobm9ybWFsaXplZFBhdGgsIHRlbXBsYXRlQ29udGVudHNcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccypkYXRlXFxzKn19L2dpLCBmaWxlbmFtZSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp0aW1lXFxzKn19L2dpLCBtb21lbnQoKS5mb3JtYXQoXCJISDptbVwiKSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp0aXRsZVxccyp9fS9naSwgZmlsZW5hbWUpXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqKGRhdGV8dGltZSlcXHMqKChbKy1dXFxkKykoW3lxbXdkaHNdKSk/XFxzKig6Lis/KT99fS9naSwgKF8sIF90aW1lT3JEYXRlLCBjYWxjLCB0aW1lRGVsdGEsIHVuaXQsIG1vbWVudEZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gbW9tZW50KCk7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IGRhdGUuY2xvbmUoKS5zZXQoe1xuICAgICAgICAgICAgICAgIGhvdXI6IG5vdy5nZXQoXCJob3VyXCIpLFxuICAgICAgICAgICAgICAgIG1pbnV0ZTogbm93LmdldChcIm1pbnV0ZVwiKSxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IG5vdy5nZXQoXCJzZWNvbmRcIiksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChjYWxjKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudERhdGUuYWRkKHBhcnNlSW50KHRpbWVEZWx0YSwgMTApLCB1bml0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtb21lbnRGb3JtYXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudERhdGUuZm9ybWF0KG1vbWVudEZvcm1hdC5zdWJzdHJpbmcoMSkudHJpbSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50RGF0ZS5mb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp5ZXN0ZXJkYXlcXHMqfX0vZ2ksIGRhdGUuY2xvbmUoKS5zdWJ0cmFjdCgxLCBcImRheVwiKS5mb3JtYXQoZm9ybWF0KSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp0b21vcnJvd1xccyp9fS9naSwgZGF0ZS5jbG9uZSgpLmFkZCgxLCBcImRcIikuZm9ybWF0KGZvcm1hdCkpKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgYXBwLmZvbGRNYW5hZ2VyLnNhdmUoY3JlYXRlZEZpbGUsIElGb2xkSW5mbyk7XG4gICAgICAgIHJldHVybiBjcmVhdGVkRmlsZTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICcke25vcm1hbGl6ZWRQYXRofSdgLCBlcnIpO1xuICAgICAgICBuZXcgb2JzaWRpYW4uTm90aWNlKFwiVW5hYmxlIHRvIGNyZWF0ZSBuZXcgZmlsZS5cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0RGFpbHlOb3RlKGRhdGUsIGRhaWx5Tm90ZXMpIHtcbiAgICByZXR1cm4gZGFpbHlOb3Rlc1tnZXREYXRlVUlEKGRhdGUsIFwiZGF5XCIpXSA/PyBudWxsO1xufVxuZnVuY3Rpb24gZ2V0QWxsRGFpbHlOb3RlcygpIHtcbiAgICAvKipcbiAgICAgKiBGaW5kIGFsbCBkYWlseSBub3RlcyBpbiB0aGUgZGFpbHkgbm90ZSBmb2xkZXJcbiAgICAgKi9cbiAgICBjb25zdCB7IHZhdWx0IH0gPSB3aW5kb3cuYXBwO1xuICAgIGNvbnN0IHsgZm9sZGVyIH0gPSBnZXREYWlseU5vdGVTZXR0aW5ncygpO1xuICAgIGNvbnN0IGRhaWx5Tm90ZXNGb2xkZXIgPSB2YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgob2JzaWRpYW4ubm9ybWFsaXplUGF0aChmb2xkZXIpKTtcbiAgICBpZiAoIWRhaWx5Tm90ZXNGb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IERhaWx5Tm90ZXNGb2xkZXJNaXNzaW5nRXJyb3IoXCJGYWlsZWQgdG8gZmluZCBkYWlseSBub3RlcyBmb2xkZXJcIik7XG4gICAgfVxuICAgIGNvbnN0IGRhaWx5Tm90ZXMgPSB7fTtcbiAgICBvYnNpZGlhbi5WYXVsdC5yZWN1cnNlQ2hpbGRyZW4oZGFpbHlOb3Rlc0ZvbGRlciwgKG5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUgaW5zdGFuY2VvZiBvYnNpZGlhbi5URmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IGdldERhdGVGcm9tRmlsZShub3RlLCBcImRheVwiKTtcbiAgICAgICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0cmluZyA9IGdldERhdGVVSUQoZGF0ZSwgXCJkYXlcIik7XG4gICAgICAgICAgICAgICAgZGFpbHlOb3Rlc1tkYXRlU3RyaW5nXSA9IG5vdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gZGFpbHlOb3Rlcztcbn1cblxuY2xhc3MgV2Vla2x5Tm90ZXNGb2xkZXJNaXNzaW5nRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG59XG5mdW5jdGlvbiBnZXREYXlzT2ZXZWVrKCkge1xuICAgIGNvbnN0IHsgbW9tZW50IH0gPSB3aW5kb3c7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBsZXQgd2Vla1N0YXJ0ID0gbW9tZW50LmxvY2FsZURhdGEoKS5fd2Vlay5kb3c7XG4gICAgY29uc3QgZGF5c09mV2VlayA9IFtcbiAgICAgICAgXCJzdW5kYXlcIixcbiAgICAgICAgXCJtb25kYXlcIixcbiAgICAgICAgXCJ0dWVzZGF5XCIsXG4gICAgICAgIFwid2VkbmVzZGF5XCIsXG4gICAgICAgIFwidGh1cnNkYXlcIixcbiAgICAgICAgXCJmcmlkYXlcIixcbiAgICAgICAgXCJzYXR1cmRheVwiLFxuICAgIF07XG4gICAgd2hpbGUgKHdlZWtTdGFydCkge1xuICAgICAgICBkYXlzT2ZXZWVrLnB1c2goZGF5c09mV2Vlay5zaGlmdCgpKTtcbiAgICAgICAgd2Vla1N0YXJ0LS07XG4gICAgfVxuICAgIHJldHVybiBkYXlzT2ZXZWVrO1xufVxuZnVuY3Rpb24gZ2V0RGF5T2ZXZWVrTnVtZXJpY2FsVmFsdWUoZGF5T2ZXZWVrTmFtZSkge1xuICAgIHJldHVybiBnZXREYXlzT2ZXZWVrKCkuaW5kZXhPZihkYXlPZldlZWtOYW1lLnRvTG93ZXJDYXNlKCkpO1xufVxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlV2Vla2x5Tm90ZShkYXRlKSB7XG4gICAgY29uc3QgeyB2YXVsdCB9ID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB7IHRlbXBsYXRlLCBmb3JtYXQsIGZvbGRlciB9ID0gZ2V0V2Vla2x5Tm90ZVNldHRpbmdzKCk7XG4gICAgY29uc3QgW3RlbXBsYXRlQ29udGVudHMsIElGb2xkSW5mb10gPSBhd2FpdCBnZXRUZW1wbGF0ZUluZm8odGVtcGxhdGUpO1xuICAgIGNvbnN0IGZpbGVuYW1lID0gZGF0ZS5mb3JtYXQoZm9ybWF0KTtcbiAgICBjb25zdCBub3JtYWxpemVkUGF0aCA9IGF3YWl0IGdldE5vdGVQYXRoKGZvbGRlciwgZmlsZW5hbWUpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZWRGaWxlID0gYXdhaXQgdmF1bHQuY3JlYXRlKG5vcm1hbGl6ZWRQYXRoLCB0ZW1wbGF0ZUNvbnRlbnRzXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqKGRhdGV8dGltZSlcXHMqKChbKy1dXFxkKykoW3lxbXdkaHNdKSk/XFxzKig6Lis/KT99fS9naSwgKF8sIF90aW1lT3JEYXRlLCBjYWxjLCB0aW1lRGVsdGEsIHVuaXQsIG1vbWVudEZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gd2luZG93Lm1vbWVudCgpO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBkYXRlLmNsb25lKCkuc2V0KHtcbiAgICAgICAgICAgICAgICBob3VyOiBub3cuZ2V0KFwiaG91clwiKSxcbiAgICAgICAgICAgICAgICBtaW51dGU6IG5vdy5nZXQoXCJtaW51dGVcIiksXG4gICAgICAgICAgICAgICAgc2Vjb25kOiBub3cuZ2V0KFwic2Vjb25kXCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoY2FsYykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlLmFkZChwYXJzZUludCh0aW1lRGVsdGEsIDEwKSwgdW5pdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW9tZW50Rm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnREYXRlLmZvcm1hdChtb21lbnRGb3JtYXQuc3Vic3RyaW5nKDEpLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudERhdGUuZm9ybWF0KGZvcm1hdCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqdGl0bGVcXHMqfX0vZ2ksIGZpbGVuYW1lKVxuICAgICAgICAgICAgLnJlcGxhY2UoL3t7XFxzKnRpbWVcXHMqfX0vZ2ksIHdpbmRvdy5tb21lbnQoKS5mb3JtYXQoXCJISDptbVwiKSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyooc3VuZGF5fG1vbmRheXx0dWVzZGF5fHdlZG5lc2RheXx0aHVyc2RheXxmcmlkYXl8c2F0dXJkYXkpXFxzKjooLio/KX19L2dpLCAoXywgZGF5T2ZXZWVrLCBtb21lbnRGb3JtYXQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRheSA9IGdldERheU9mV2Vla051bWVyaWNhbFZhbHVlKGRheU9mV2Vlayk7XG4gICAgICAgICAgICByZXR1cm4gZGF0ZS53ZWVrZGF5KGRheSkuZm9ybWF0KG1vbWVudEZvcm1hdC50cmltKCkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHdpbmRvdy5hcHAuZm9sZE1hbmFnZXIuc2F2ZShjcmVhdGVkRmlsZSwgSUZvbGRJbmZvKTtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZWRGaWxlO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZmlsZTogJyR7bm9ybWFsaXplZFBhdGh9J2AsIGVycik7XG4gICAgICAgIG5ldyBvYnNpZGlhbi5Ob3RpY2UoXCJVbmFibGUgdG8gY3JlYXRlIG5ldyBmaWxlLlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRXZWVrbHlOb3RlKGRhdGUsIHdlZWtseU5vdGVzKSB7XG4gICAgcmV0dXJuIHdlZWtseU5vdGVzW2dldERhdGVVSUQoZGF0ZSwgXCJ3ZWVrXCIpXSA/PyBudWxsO1xufVxuZnVuY3Rpb24gZ2V0QWxsV2Vla2x5Tm90ZXMoKSB7XG4gICAgY29uc3Qgd2Vla2x5Tm90ZXMgPSB7fTtcbiAgICBpZiAoIWFwcEhhc1dlZWtseU5vdGVzUGx1Z2luTG9hZGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHdlZWtseU5vdGVzO1xuICAgIH1cbiAgICBjb25zdCB7IHZhdWx0IH0gPSB3aW5kb3cuYXBwO1xuICAgIGNvbnN0IHsgZm9sZGVyIH0gPSBnZXRXZWVrbHlOb3RlU2V0dGluZ3MoKTtcbiAgICBjb25zdCB3ZWVrbHlOb3Rlc0ZvbGRlciA9IHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChvYnNpZGlhbi5ub3JtYWxpemVQYXRoKGZvbGRlcikpO1xuICAgIGlmICghd2Vla2x5Tm90ZXNGb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFdlZWtseU5vdGVzRm9sZGVyTWlzc2luZ0Vycm9yKFwiRmFpbGVkIHRvIGZpbmQgd2Vla2x5IG5vdGVzIGZvbGRlclwiKTtcbiAgICB9XG4gICAgb2JzaWRpYW4uVmF1bHQucmVjdXJzZUNoaWxkcmVuKHdlZWtseU5vdGVzRm9sZGVyLCAobm90ZSkgPT4ge1xuICAgICAgICBpZiAobm90ZSBpbnN0YW5jZW9mIG9ic2lkaWFuLlRGaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRlID0gZ2V0RGF0ZUZyb21GaWxlKG5vdGUsIFwid2Vla1wiKTtcbiAgICAgICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0cmluZyA9IGdldERhdGVVSUQoZGF0ZSwgXCJ3ZWVrXCIpO1xuICAgICAgICAgICAgICAgIHdlZWtseU5vdGVzW2RhdGVTdHJpbmddID0gbm90ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB3ZWVrbHlOb3Rlcztcbn1cblxuY2xhc3MgTW9udGhseU5vdGVzRm9sZGVyTWlzc2luZ0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xufVxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIG1pbWljcyB0aGUgYmVoYXZpb3Igb2YgdGhlIGRhaWx5LW5vdGVzIHBsdWdpblxuICogc28gaXQgd2lsbCByZXBsYWNlIHt7ZGF0ZX19LCB7e3RpdGxlfX0sIGFuZCB7e3RpbWV9fSB3aXRoIHRoZVxuICogZm9ybWF0dGVkIHRpbWVzdGFtcC5cbiAqXG4gKiBOb3RlOiBpdCBoYXMgYW4gYWRkZWQgYm9udXMgdGhhdCBpdCdzIG5vdCAndG9kYXknIHNwZWNpZmljLlxuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVNb250aGx5Tm90ZShkYXRlKSB7XG4gICAgY29uc3QgeyB2YXVsdCB9ID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB7IHRlbXBsYXRlLCBmb3JtYXQsIGZvbGRlciB9ID0gZ2V0TW9udGhseU5vdGVTZXR0aW5ncygpO1xuICAgIGNvbnN0IFt0ZW1wbGF0ZUNvbnRlbnRzLCBJRm9sZEluZm9dID0gYXdhaXQgZ2V0VGVtcGxhdGVJbmZvKHRlbXBsYXRlKTtcbiAgICBjb25zdCBmaWxlbmFtZSA9IGRhdGUuZm9ybWF0KGZvcm1hdCk7XG4gICAgY29uc3Qgbm9ybWFsaXplZFBhdGggPSBhd2FpdCBnZXROb3RlUGF0aChmb2xkZXIsIGZpbGVuYW1lKTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBjcmVhdGVkRmlsZSA9IGF3YWl0IHZhdWx0LmNyZWF0ZShub3JtYWxpemVkUGF0aCwgdGVtcGxhdGVDb250ZW50c1xuICAgICAgICAgICAgLnJlcGxhY2UoL3t7XFxzKihkYXRlfHRpbWUpXFxzKigoWystXVxcZCspKFt5cW13ZGhzXSkpP1xccyooOi4rPyk/fX0vZ2ksIChfLCBfdGltZU9yRGF0ZSwgY2FsYywgdGltZURlbHRhLCB1bml0LCBtb21lbnRGb3JtYXQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IHdpbmRvdy5tb21lbnQoKTtcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnREYXRlID0gZGF0ZS5jbG9uZSgpLnNldCh7XG4gICAgICAgICAgICAgICAgaG91cjogbm93LmdldChcImhvdXJcIiksXG4gICAgICAgICAgICAgICAgbWludXRlOiBub3cuZ2V0KFwibWludXRlXCIpLFxuICAgICAgICAgICAgICAgIHNlY29uZDogbm93LmdldChcInNlY29uZFwiKSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGNhbGMpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZS5hZGQocGFyc2VJbnQodGltZURlbHRhLCAxMCksIHVuaXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1vbWVudEZvcm1hdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjdXJyZW50RGF0ZS5mb3JtYXQobW9tZW50Rm9ybWF0LnN1YnN0cmluZygxKS50cmltKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnREYXRlLmZvcm1hdChmb3JtYXQpO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLnJlcGxhY2UoL3t7XFxzKmRhdGVcXHMqfX0vZ2ksIGZpbGVuYW1lKVxuICAgICAgICAgICAgLnJlcGxhY2UoL3t7XFxzKnRpbWVcXHMqfX0vZ2ksIHdpbmRvdy5tb21lbnQoKS5mb3JtYXQoXCJISDptbVwiKSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp0aXRsZVxccyp9fS9naSwgZmlsZW5hbWUpKTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgd2luZG93LmFwcC5mb2xkTWFuYWdlci5zYXZlKGNyZWF0ZWRGaWxlLCBJRm9sZEluZm8pO1xuICAgICAgICByZXR1cm4gY3JlYXRlZEZpbGU7XG4gICAgfVxuICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSBmaWxlOiAnJHtub3JtYWxpemVkUGF0aH0nYCwgZXJyKTtcbiAgICAgICAgbmV3IG9ic2lkaWFuLk5vdGljZShcIlVuYWJsZSB0byBjcmVhdGUgbmV3IGZpbGUuXCIpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGdldE1vbnRobHlOb3RlKGRhdGUsIG1vbnRobHlOb3Rlcykge1xuICAgIHJldHVybiBtb250aGx5Tm90ZXNbZ2V0RGF0ZVVJRChkYXRlLCBcIm1vbnRoXCIpXSA/PyBudWxsO1xufVxuZnVuY3Rpb24gZ2V0QWxsTW9udGhseU5vdGVzKCkge1xuICAgIGNvbnN0IG1vbnRobHlOb3RlcyA9IHt9O1xuICAgIGlmICghYXBwSGFzTW9udGhseU5vdGVzUGx1Z2luTG9hZGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIG1vbnRobHlOb3RlcztcbiAgICB9XG4gICAgY29uc3QgeyB2YXVsdCB9ID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB7IGZvbGRlciB9ID0gZ2V0TW9udGhseU5vdGVTZXR0aW5ncygpO1xuICAgIGNvbnN0IG1vbnRobHlOb3Rlc0ZvbGRlciA9IHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChvYnNpZGlhbi5ub3JtYWxpemVQYXRoKGZvbGRlcikpO1xuICAgIGlmICghbW9udGhseU5vdGVzRm9sZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBNb250aGx5Tm90ZXNGb2xkZXJNaXNzaW5nRXJyb3IoXCJGYWlsZWQgdG8gZmluZCBtb250aGx5IG5vdGVzIGZvbGRlclwiKTtcbiAgICB9XG4gICAgb2JzaWRpYW4uVmF1bHQucmVjdXJzZUNoaWxkcmVuKG1vbnRobHlOb3Rlc0ZvbGRlciwgKG5vdGUpID0+IHtcbiAgICAgICAgaWYgKG5vdGUgaW5zdGFuY2VvZiBvYnNpZGlhbi5URmlsZSkge1xuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IGdldERhdGVGcm9tRmlsZShub3RlLCBcIm1vbnRoXCIpO1xuICAgICAgICAgICAgaWYgKGRhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRlU3RyaW5nID0gZ2V0RGF0ZVVJRChkYXRlLCBcIm1vbnRoXCIpO1xuICAgICAgICAgICAgICAgIG1vbnRobHlOb3Rlc1tkYXRlU3RyaW5nXSA9IG5vdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gbW9udGhseU5vdGVzO1xufVxuXG5jbGFzcyBRdWFydGVybHlOb3Rlc0ZvbGRlck1pc3NpbmdFcnJvciBleHRlbmRzIEVycm9yIHtcbn1cbi8qKlxuICogVGhpcyBmdW5jdGlvbiBtaW1pY3MgdGhlIGJlaGF2aW9yIG9mIHRoZSBkYWlseS1ub3RlcyBwbHVnaW5cbiAqIHNvIGl0IHdpbGwgcmVwbGFjZSB7e2RhdGV9fSwge3t0aXRsZX19LCBhbmQge3t0aW1lfX0gd2l0aCB0aGVcbiAqIGZvcm1hdHRlZCB0aW1lc3RhbXAuXG4gKlxuICogTm90ZTogaXQgaGFzIGFuIGFkZGVkIGJvbnVzIHRoYXQgaXQncyBub3QgJ3RvZGF5JyBzcGVjaWZpYy5cbiAqL1xuYXN5bmMgZnVuY3Rpb24gY3JlYXRlUXVhcnRlcmx5Tm90ZShkYXRlKSB7XG4gICAgY29uc3QgeyB2YXVsdCB9ID0gd2luZG93LmFwcDtcbiAgICBjb25zdCB7IHRlbXBsYXRlLCBmb3JtYXQsIGZvbGRlciB9ID0gZ2V0UXVhcnRlcmx5Tm90ZVNldHRpbmdzKCk7XG4gICAgY29uc3QgW3RlbXBsYXRlQ29udGVudHMsIElGb2xkSW5mb10gPSBhd2FpdCBnZXRUZW1wbGF0ZUluZm8odGVtcGxhdGUpO1xuICAgIGNvbnN0IGZpbGVuYW1lID0gZGF0ZS5mb3JtYXQoZm9ybWF0KTtcbiAgICBjb25zdCBub3JtYWxpemVkUGF0aCA9IGF3YWl0IGdldE5vdGVQYXRoKGZvbGRlciwgZmlsZW5hbWUpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGNyZWF0ZWRGaWxlID0gYXdhaXQgdmF1bHQuY3JlYXRlKG5vcm1hbGl6ZWRQYXRoLCB0ZW1wbGF0ZUNvbnRlbnRzXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqKGRhdGV8dGltZSlcXHMqKChbKy1dXFxkKykoW3lxbXdkaHNdKSk/XFxzKig6Lis/KT99fS9naSwgKF8sIF90aW1lT3JEYXRlLCBjYWxjLCB0aW1lRGVsdGEsIHVuaXQsIG1vbWVudEZvcm1hdCkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gd2luZG93Lm1vbWVudCgpO1xuICAgICAgICAgICAgY29uc3QgY3VycmVudERhdGUgPSBkYXRlLmNsb25lKCkuc2V0KHtcbiAgICAgICAgICAgICAgICBob3VyOiBub3cuZ2V0KFwiaG91clwiKSxcbiAgICAgICAgICAgICAgICBtaW51dGU6IG5vdy5nZXQoXCJtaW51dGVcIiksXG4gICAgICAgICAgICAgICAgc2Vjb25kOiBub3cuZ2V0KFwic2Vjb25kXCIpLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoY2FsYykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlLmFkZChwYXJzZUludCh0aW1lRGVsdGEsIDEwKSwgdW5pdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobW9tZW50Rm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGN1cnJlbnREYXRlLmZvcm1hdChtb21lbnRGb3JtYXQuc3Vic3RyaW5nKDEpLnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY3VycmVudERhdGUuZm9ybWF0KGZvcm1hdCk7XG4gICAgICAgIH0pXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqZGF0ZVxccyp9fS9naSwgZmlsZW5hbWUpXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqdGltZVxccyp9fS9naSwgd2luZG93Lm1vbWVudCgpLmZvcm1hdChcIkhIOm1tXCIpKVxuICAgICAgICAgICAgLnJlcGxhY2UoL3t7XFxzKnRpdGxlXFxzKn19L2dpLCBmaWxlbmFtZSkpO1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICB3aW5kb3cuYXBwLmZvbGRNYW5hZ2VyLnNhdmUoY3JlYXRlZEZpbGUsIElGb2xkSW5mbyk7XG4gICAgICAgIHJldHVybiBjcmVhdGVkRmlsZTtcbiAgICB9XG4gICAgY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICcke25vcm1hbGl6ZWRQYXRofSdgLCBlcnIpO1xuICAgICAgICBuZXcgb2JzaWRpYW4uTm90aWNlKFwiVW5hYmxlIHRvIGNyZWF0ZSBuZXcgZmlsZS5cIik7XG4gICAgfVxufVxuZnVuY3Rpb24gZ2V0UXVhcnRlcmx5Tm90ZShkYXRlLCBxdWFydGVybHkpIHtcbiAgICByZXR1cm4gcXVhcnRlcmx5W2dldERhdGVVSUQoZGF0ZSwgXCJxdWFydGVyXCIpXSA/PyBudWxsO1xufVxuZnVuY3Rpb24gZ2V0QWxsUXVhcnRlcmx5Tm90ZXMoKSB7XG4gICAgY29uc3QgcXVhcnRlcmx5ID0ge307XG4gICAgaWYgKCFhcHBIYXNRdWFydGVybHlOb3Rlc1BsdWdpbkxvYWRlZCgpKSB7XG4gICAgICAgIHJldHVybiBxdWFydGVybHk7XG4gICAgfVxuICAgIGNvbnN0IHsgdmF1bHQgfSA9IHdpbmRvdy5hcHA7XG4gICAgY29uc3QgeyBmb2xkZXIgfSA9IGdldFF1YXJ0ZXJseU5vdGVTZXR0aW5ncygpO1xuICAgIGNvbnN0IHF1YXJ0ZXJseUZvbGRlciA9IHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChvYnNpZGlhbi5ub3JtYWxpemVQYXRoKGZvbGRlcikpO1xuICAgIGlmICghcXVhcnRlcmx5Rm9sZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBRdWFydGVybHlOb3Rlc0ZvbGRlck1pc3NpbmdFcnJvcihcIkZhaWxlZCB0byBmaW5kIHF1YXJ0ZXJseSBub3RlcyBmb2xkZXJcIik7XG4gICAgfVxuICAgIG9ic2lkaWFuLlZhdWx0LnJlY3Vyc2VDaGlsZHJlbihxdWFydGVybHlGb2xkZXIsIChub3RlKSA9PiB7XG4gICAgICAgIGlmIChub3RlIGluc3RhbmNlb2Ygb2JzaWRpYW4uVEZpbGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBnZXREYXRlRnJvbUZpbGUobm90ZSwgXCJxdWFydGVyXCIpO1xuICAgICAgICAgICAgaWYgKGRhdGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRlU3RyaW5nID0gZ2V0RGF0ZVVJRChkYXRlLCBcInF1YXJ0ZXJcIik7XG4gICAgICAgICAgICAgICAgcXVhcnRlcmx5W2RhdGVTdHJpbmddID0gbm90ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBxdWFydGVybHk7XG59XG5cbmNsYXNzIFllYXJseU5vdGVzRm9sZGVyTWlzc2luZ0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xufVxuLyoqXG4gKiBUaGlzIGZ1bmN0aW9uIG1pbWljcyB0aGUgYmVoYXZpb3Igb2YgdGhlIGRhaWx5LW5vdGVzIHBsdWdpblxuICogc28gaXQgd2lsbCByZXBsYWNlIHt7ZGF0ZX19LCB7e3RpdGxlfX0sIGFuZCB7e3RpbWV9fSB3aXRoIHRoZVxuICogZm9ybWF0dGVkIHRpbWVzdGFtcC5cbiAqXG4gKiBOb3RlOiBpdCBoYXMgYW4gYWRkZWQgYm9udXMgdGhhdCBpdCdzIG5vdCAndG9kYXknIHNwZWNpZmljLlxuICovXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVZZWFybHlOb3RlKGRhdGUpIHtcbiAgICBjb25zdCB7IHZhdWx0IH0gPSB3aW5kb3cuYXBwO1xuICAgIGNvbnN0IHsgdGVtcGxhdGUsIGZvcm1hdCwgZm9sZGVyIH0gPSBnZXRZZWFybHlOb3RlU2V0dGluZ3MoKTtcbiAgICBjb25zdCBbdGVtcGxhdGVDb250ZW50cywgSUZvbGRJbmZvXSA9IGF3YWl0IGdldFRlbXBsYXRlSW5mbyh0ZW1wbGF0ZSk7XG4gICAgY29uc3QgZmlsZW5hbWUgPSBkYXRlLmZvcm1hdChmb3JtYXQpO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRQYXRoID0gYXdhaXQgZ2V0Tm90ZVBhdGgoZm9sZGVyLCBmaWxlbmFtZSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgY3JlYXRlZEZpbGUgPSBhd2FpdCB2YXVsdC5jcmVhdGUobm9ybWFsaXplZFBhdGgsIHRlbXBsYXRlQ29udGVudHNcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyooZGF0ZXx0aW1lKVxccyooKFsrLV1cXGQrKShbeXFtd2Roc10pKT9cXHMqKDouKz8pP319L2dpLCAoXywgX3RpbWVPckRhdGUsIGNhbGMsIHRpbWVEZWx0YSwgdW5pdCwgbW9tZW50Rm9ybWF0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBub3cgPSB3aW5kb3cubW9tZW50KCk7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RGF0ZSA9IGRhdGUuY2xvbmUoKS5zZXQoe1xuICAgICAgICAgICAgICAgIGhvdXI6IG5vdy5nZXQoXCJob3VyXCIpLFxuICAgICAgICAgICAgICAgIG1pbnV0ZTogbm93LmdldChcIm1pbnV0ZVwiKSxcbiAgICAgICAgICAgICAgICBzZWNvbmQ6IG5vdy5nZXQoXCJzZWNvbmRcIiksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChjYWxjKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudERhdGUuYWRkKHBhcnNlSW50KHRpbWVEZWx0YSwgMTApLCB1bml0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtb21lbnRGb3JtYXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY3VycmVudERhdGUuZm9ybWF0KG1vbWVudEZvcm1hdC5zdWJzdHJpbmcoMSkudHJpbSgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjdXJyZW50RGF0ZS5mb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccypkYXRlXFxzKn19L2dpLCBmaWxlbmFtZSlcbiAgICAgICAgICAgIC5yZXBsYWNlKC97e1xccyp0aW1lXFxzKn19L2dpLCB3aW5kb3cubW9tZW50KCkuZm9ybWF0KFwiSEg6bW1cIikpXG4gICAgICAgICAgICAucmVwbGFjZSgve3tcXHMqdGl0bGVcXHMqfX0vZ2ksIGZpbGVuYW1lKSk7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHdpbmRvdy5hcHAuZm9sZE1hbmFnZXIuc2F2ZShjcmVhdGVkRmlsZSwgSUZvbGRJbmZvKTtcbiAgICAgICAgcmV0dXJuIGNyZWF0ZWRGaWxlO1xuICAgIH1cbiAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEZhaWxlZCB0byBjcmVhdGUgZmlsZTogJyR7bm9ybWFsaXplZFBhdGh9J2AsIGVycik7XG4gICAgICAgIG5ldyBvYnNpZGlhbi5Ob3RpY2UoXCJVbmFibGUgdG8gY3JlYXRlIG5ldyBmaWxlLlwiKTtcbiAgICB9XG59XG5mdW5jdGlvbiBnZXRZZWFybHlOb3RlKGRhdGUsIHllYXJseU5vdGVzKSB7XG4gICAgcmV0dXJuIHllYXJseU5vdGVzW2dldERhdGVVSUQoZGF0ZSwgXCJ5ZWFyXCIpXSA/PyBudWxsO1xufVxuZnVuY3Rpb24gZ2V0QWxsWWVhcmx5Tm90ZXMoKSB7XG4gICAgY29uc3QgeWVhcmx5Tm90ZXMgPSB7fTtcbiAgICBpZiAoIWFwcEhhc1llYXJseU5vdGVzUGx1Z2luTG9hZGVkKCkpIHtcbiAgICAgICAgcmV0dXJuIHllYXJseU5vdGVzO1xuICAgIH1cbiAgICBjb25zdCB7IHZhdWx0IH0gPSB3aW5kb3cuYXBwO1xuICAgIGNvbnN0IHsgZm9sZGVyIH0gPSBnZXRZZWFybHlOb3RlU2V0dGluZ3MoKTtcbiAgICBjb25zdCB5ZWFybHlOb3Rlc0ZvbGRlciA9IHZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChvYnNpZGlhbi5ub3JtYWxpemVQYXRoKGZvbGRlcikpO1xuICAgIGlmICgheWVhcmx5Tm90ZXNGb2xkZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFllYXJseU5vdGVzRm9sZGVyTWlzc2luZ0Vycm9yKFwiRmFpbGVkIHRvIGZpbmQgeWVhcmx5IG5vdGVzIGZvbGRlclwiKTtcbiAgICB9XG4gICAgb2JzaWRpYW4uVmF1bHQucmVjdXJzZUNoaWxkcmVuKHllYXJseU5vdGVzRm9sZGVyLCAobm90ZSkgPT4ge1xuICAgICAgICBpZiAobm90ZSBpbnN0YW5jZW9mIG9ic2lkaWFuLlRGaWxlKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRlID0gZ2V0RGF0ZUZyb21GaWxlKG5vdGUsIFwieWVhclwiKTtcbiAgICAgICAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZVN0cmluZyA9IGdldERhdGVVSUQoZGF0ZSwgXCJ5ZWFyXCIpO1xuICAgICAgICAgICAgICAgIHllYXJseU5vdGVzW2RhdGVTdHJpbmddID0gbm90ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiB5ZWFybHlOb3Rlcztcbn1cblxuZnVuY3Rpb24gYXBwSGFzRGFpbHlOb3Rlc1BsdWdpbkxvYWRlZCgpIHtcbiAgICBjb25zdCB7IGFwcCB9ID0gd2luZG93O1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgY29uc3QgZGFpbHlOb3Rlc1BsdWdpbiA9IGFwcC5pbnRlcm5hbFBsdWdpbnMucGx1Z2luc1tcImRhaWx5LW5vdGVzXCJdO1xuICAgIGlmIChkYWlseU5vdGVzUGx1Z2luICYmIGRhaWx5Tm90ZXNQbHVnaW4uZW5hYmxlZCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwZXJpb2RpY05vdGVzID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwicGVyaW9kaWMtbm90ZXNcIik7XG4gICAgcmV0dXJuIHBlcmlvZGljTm90ZXMgJiYgcGVyaW9kaWNOb3Rlcy5zZXR0aW5ncz8uZGFpbHk/LmVuYWJsZWQ7XG59XG4vKipcbiAqIFhYWDogXCJXZWVrbHkgTm90ZXNcIiBsaXZlIGluIGVpdGhlciB0aGUgQ2FsZW5kYXIgcGx1Z2luIG9yIHRoZSBwZXJpb2RpYy1ub3RlcyBwbHVnaW4uXG4gKiBDaGVjayBib3RoIHVudGlsIHRoZSB3ZWVrbHkgbm90ZXMgZmVhdHVyZSBpcyByZW1vdmVkIGZyb20gdGhlIENhbGVuZGFyIHBsdWdpbi5cbiAqL1xuZnVuY3Rpb24gYXBwSGFzV2Vla2x5Tm90ZXNQbHVnaW5Mb2FkZWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHdpbmRvdztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGlmIChhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJjYWxlbmRhclwiKSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwZXJpb2RpY05vdGVzID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwicGVyaW9kaWMtbm90ZXNcIik7XG4gICAgcmV0dXJuIHBlcmlvZGljTm90ZXMgJiYgcGVyaW9kaWNOb3Rlcy5zZXR0aW5ncz8ud2Vla2x5Py5lbmFibGVkO1xufVxuZnVuY3Rpb24gYXBwSGFzTW9udGhseU5vdGVzUGx1Z2luTG9hZGVkKCkge1xuICAgIGNvbnN0IHsgYXBwIH0gPSB3aW5kb3c7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwZXJpb2RpY05vdGVzID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwicGVyaW9kaWMtbm90ZXNcIik7XG4gICAgcmV0dXJuIHBlcmlvZGljTm90ZXMgJiYgcGVyaW9kaWNOb3Rlcy5zZXR0aW5ncz8ubW9udGhseT8uZW5hYmxlZDtcbn1cbmZ1bmN0aW9uIGFwcEhhc1F1YXJ0ZXJseU5vdGVzUGx1Z2luTG9hZGVkKCkge1xuICAgIGNvbnN0IHsgYXBwIH0gPSB3aW5kb3c7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBjb25zdCBwZXJpb2RpY05vdGVzID0gYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKFwicGVyaW9kaWMtbm90ZXNcIik7XG4gICAgcmV0dXJuIHBlcmlvZGljTm90ZXMgJiYgcGVyaW9kaWNOb3Rlcy5zZXR0aW5ncz8ucXVhcnRlcmx5Py5lbmFibGVkO1xufVxuZnVuY3Rpb24gYXBwSGFzWWVhcmx5Tm90ZXNQbHVnaW5Mb2FkZWQoKSB7XG4gICAgY29uc3QgeyBhcHAgfSA9IHdpbmRvdztcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgIGNvbnN0IHBlcmlvZGljTm90ZXMgPSBhcHAucGx1Z2lucy5nZXRQbHVnaW4oXCJwZXJpb2RpYy1ub3Rlc1wiKTtcbiAgICByZXR1cm4gcGVyaW9kaWNOb3RlcyAmJiBwZXJpb2RpY05vdGVzLnNldHRpbmdzPy55ZWFybHk/LmVuYWJsZWQ7XG59XG5mdW5jdGlvbiBnZXRQZXJpb2RpY05vdGVTZXR0aW5ncyhncmFudWxhcml0eSkge1xuICAgIGNvbnN0IGdldFNldHRpbmdzID0ge1xuICAgICAgICBkYXk6IGdldERhaWx5Tm90ZVNldHRpbmdzLFxuICAgICAgICB3ZWVrOiBnZXRXZWVrbHlOb3RlU2V0dGluZ3MsXG4gICAgICAgIG1vbnRoOiBnZXRNb250aGx5Tm90ZVNldHRpbmdzLFxuICAgICAgICBxdWFydGVyOiBnZXRRdWFydGVybHlOb3RlU2V0dGluZ3MsXG4gICAgICAgIHllYXI6IGdldFllYXJseU5vdGVTZXR0aW5ncyxcbiAgICB9W2dyYW51bGFyaXR5XTtcbiAgICByZXR1cm4gZ2V0U2V0dGluZ3MoKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZVBlcmlvZGljTm90ZShncmFudWxhcml0eSwgZGF0ZSkge1xuICAgIGNvbnN0IGNyZWF0ZUZuID0ge1xuICAgICAgICBkYXk6IGNyZWF0ZURhaWx5Tm90ZSxcbiAgICAgICAgbW9udGg6IGNyZWF0ZU1vbnRobHlOb3RlLFxuICAgICAgICB3ZWVrOiBjcmVhdGVXZWVrbHlOb3RlLFxuICAgIH07XG4gICAgcmV0dXJuIGNyZWF0ZUZuW2dyYW51bGFyaXR5XShkYXRlKTtcbn1cblxuZXhwb3J0cy5ERUZBVUxUX0RBSUxZX05PVEVfRk9STUFUID0gREVGQVVMVF9EQUlMWV9OT1RFX0ZPUk1BVDtcbmV4cG9ydHMuREVGQVVMVF9NT05USExZX05PVEVfRk9STUFUID0gREVGQVVMVF9NT05USExZX05PVEVfRk9STUFUO1xuZXhwb3J0cy5ERUZBVUxUX1FVQVJURVJMWV9OT1RFX0ZPUk1BVCA9IERFRkFVTFRfUVVBUlRFUkxZX05PVEVfRk9STUFUO1xuZXhwb3J0cy5ERUZBVUxUX1dFRUtMWV9OT1RFX0ZPUk1BVCA9IERFRkFVTFRfV0VFS0xZX05PVEVfRk9STUFUO1xuZXhwb3J0cy5ERUZBVUxUX1lFQVJMWV9OT1RFX0ZPUk1BVCA9IERFRkFVTFRfWUVBUkxZX05PVEVfRk9STUFUO1xuZXhwb3J0cy5hcHBIYXNEYWlseU5vdGVzUGx1Z2luTG9hZGVkID0gYXBwSGFzRGFpbHlOb3Rlc1BsdWdpbkxvYWRlZDtcbmV4cG9ydHMuYXBwSGFzTW9udGhseU5vdGVzUGx1Z2luTG9hZGVkID0gYXBwSGFzTW9udGhseU5vdGVzUGx1Z2luTG9hZGVkO1xuZXhwb3J0cy5hcHBIYXNRdWFydGVybHlOb3Rlc1BsdWdpbkxvYWRlZCA9IGFwcEhhc1F1YXJ0ZXJseU5vdGVzUGx1Z2luTG9hZGVkO1xuZXhwb3J0cy5hcHBIYXNXZWVrbHlOb3Rlc1BsdWdpbkxvYWRlZCA9IGFwcEhhc1dlZWtseU5vdGVzUGx1Z2luTG9hZGVkO1xuZXhwb3J0cy5hcHBIYXNZZWFybHlOb3Rlc1BsdWdpbkxvYWRlZCA9IGFwcEhhc1llYXJseU5vdGVzUGx1Z2luTG9hZGVkO1xuZXhwb3J0cy5jcmVhdGVEYWlseU5vdGUgPSBjcmVhdGVEYWlseU5vdGU7XG5leHBvcnRzLmNyZWF0ZU1vbnRobHlOb3RlID0gY3JlYXRlTW9udGhseU5vdGU7XG5leHBvcnRzLmNyZWF0ZVBlcmlvZGljTm90ZSA9IGNyZWF0ZVBlcmlvZGljTm90ZTtcbmV4cG9ydHMuY3JlYXRlUXVhcnRlcmx5Tm90ZSA9IGNyZWF0ZVF1YXJ0ZXJseU5vdGU7XG5leHBvcnRzLmNyZWF0ZVdlZWtseU5vdGUgPSBjcmVhdGVXZWVrbHlOb3RlO1xuZXhwb3J0cy5jcmVhdGVZZWFybHlOb3RlID0gY3JlYXRlWWVhcmx5Tm90ZTtcbmV4cG9ydHMuZ2V0QWxsRGFpbHlOb3RlcyA9IGdldEFsbERhaWx5Tm90ZXM7XG5leHBvcnRzLmdldEFsbE1vbnRobHlOb3RlcyA9IGdldEFsbE1vbnRobHlOb3RlcztcbmV4cG9ydHMuZ2V0QWxsUXVhcnRlcmx5Tm90ZXMgPSBnZXRBbGxRdWFydGVybHlOb3RlcztcbmV4cG9ydHMuZ2V0QWxsV2Vla2x5Tm90ZXMgPSBnZXRBbGxXZWVrbHlOb3RlcztcbmV4cG9ydHMuZ2V0QWxsWWVhcmx5Tm90ZXMgPSBnZXRBbGxZZWFybHlOb3RlcztcbmV4cG9ydHMuZ2V0RGFpbHlOb3RlID0gZ2V0RGFpbHlOb3RlO1xuZXhwb3J0cy5nZXREYWlseU5vdGVTZXR0aW5ncyA9IGdldERhaWx5Tm90ZVNldHRpbmdzO1xuZXhwb3J0cy5nZXREYXRlRnJvbUZpbGUgPSBnZXREYXRlRnJvbUZpbGU7XG5leHBvcnRzLmdldERhdGVGcm9tUGF0aCA9IGdldERhdGVGcm9tUGF0aDtcbmV4cG9ydHMuZ2V0RGF0ZVVJRCA9IGdldERhdGVVSUQ7XG5leHBvcnRzLmdldE1vbnRobHlOb3RlID0gZ2V0TW9udGhseU5vdGU7XG5leHBvcnRzLmdldE1vbnRobHlOb3RlU2V0dGluZ3MgPSBnZXRNb250aGx5Tm90ZVNldHRpbmdzO1xuZXhwb3J0cy5nZXRQZXJpb2RpY05vdGVTZXR0aW5ncyA9IGdldFBlcmlvZGljTm90ZVNldHRpbmdzO1xuZXhwb3J0cy5nZXRRdWFydGVybHlOb3RlID0gZ2V0UXVhcnRlcmx5Tm90ZTtcbmV4cG9ydHMuZ2V0UXVhcnRlcmx5Tm90ZVNldHRpbmdzID0gZ2V0UXVhcnRlcmx5Tm90ZVNldHRpbmdzO1xuZXhwb3J0cy5nZXRUZW1wbGF0ZUluZm8gPSBnZXRUZW1wbGF0ZUluZm87XG5leHBvcnRzLmdldFdlZWtseU5vdGUgPSBnZXRXZWVrbHlOb3RlO1xuZXhwb3J0cy5nZXRXZWVrbHlOb3RlU2V0dGluZ3MgPSBnZXRXZWVrbHlOb3RlU2V0dGluZ3M7XG5leHBvcnRzLmdldFllYXJseU5vdGUgPSBnZXRZZWFybHlOb3RlO1xuZXhwb3J0cy5nZXRZZWFybHlOb3RlU2V0dGluZ3MgPSBnZXRZZWFybHlOb3RlU2V0dGluZ3M7XG4iLCAiaW1wb3J0IHtcclxuICBBcHAsXHJcbiAgVEZpbGUsXHJcbiAgRmlsZU1hbmFnZXIsXHJcbiAgZGVib3VuY2UsXHJcbiAgRWRpdG9yLFxyXG4gIE1hcmtkb3duVmlldyxcclxuICBNb2RhbCxcclxuICBtb21lbnQsXHJcbiAgTm90aWNlLFxyXG4gIFBsdWdpbixcclxuICBQbHVnaW5TZXR0aW5nVGFiLFxyXG4gIFNldHRpbmcsXHJcbiAgVG9nZ2xlQ29tcG9uZW50LFxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBleGl0IH0gZnJvbSBcInByb2Nlc3NcIjtcclxuXHJcbmltcG9ydCB7IGFwcEhhc0RhaWx5Tm90ZXNQbHVnaW5Mb2FkZWQgfSBmcm9tIFwib2JzaWRpYW4tZGFpbHktbm90ZXMtaW50ZXJmYWNlXCI7XHJcbmltcG9ydCB7XHJcbiAgZ2V0RGFpbHlOb3RlLFxyXG4gIGNyZWF0ZURhaWx5Tm90ZSxcclxuICBnZXRBbGxEYWlseU5vdGVzLFxyXG59IGZyb20gXCJvYnNpZGlhbi1kYWlseS1ub3Rlcy1pbnRlcmZhY2VcIjtcclxuXHJcbmltcG9ydCB7IGFyb3VuZCB9IGZyb20gXCJtb25rZXktYXJvdW5kXCI7XHJcblxyXG5pbXBvcnQgeyBPYnNpZGlhblJld2FyZGVyU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MsIE9ic2lkaWFuUmV3YXJkZXJTZXR0aW5nc1RhYiB9IGZyb20gXCIuL3NldHRpbmdzXCI7XHJcblxyXG4vLyBBZGQgXCJiYXRjaC1tb2RlXCIgd2hlcmUgdGhlcmUgaXMgb25seSBjYWxsLW91dCB3aGVuIGF3YXJkIHdvbiBhbmQgdGhlbiBhbGwgYXdhcmRzIGFyZSBzdG9yZWQgaW4gZGFpbHktbm90ZSBvciBiYXRjaCBmaWxlXHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGFpbHlOb3RlRmlsZSgpOiBQcm9taXNlPFRGaWxlPiB7XHJcbiAgY29uc3QgZmlsZSA9IGdldERhaWx5Tm90ZShtb21lbnQoKSwgZ2V0QWxsRGFpbHlOb3RlcygpKTtcclxuXHJcbiAgaWYgKCFmaWxlKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgY3JlYXRlRGFpbHlOb3RlKG1vbWVudCgpKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBmaWxlO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPYnNpZGlhblJld2FyZGVyIGV4dGVuZHMgUGx1Z2luIHtcclxuICBzZXR0aW5nczogT2JzaWRpYW5SZXdhcmRlclNldHRpbmdzO1xyXG5cclxuICBhc3luYyBoYW5kbGVSZXdhcmQoY2xpY2tlZFRhc2tUZXh0OiBTdHJpbmcpIHtcclxuICAgIGxldCBhcnJheU9mQ2xlYW5lZFJld2FyZHMgPSBbXTtcclxuICAgIGxldCBjaG9zZW5SZXdhcmQ7XHJcbiAgICBsZXQgcmV3YXJkc0J5T2NjdXJyZW5jZSA9IHt9O1xyXG5cclxuICAgIC8vIFJlYWQgY29udGVudHMgb2YgcmV3YXJkcyBmaWxlXHJcbiAgICBjb25zdCB7IHZhdWx0IH0gPSB0aGlzLmFwcDtcclxuICAgIGNvbnN0IHJld2FyZHNGaWxlID0gdmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3MucmV3YXJkc0ZpbGUpO1xyXG5cclxuXHJcbiAgICBpZiAocmV3YXJkc0ZpbGUgPT09IG51bGwgfHwgIShyZXdhcmRzRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG4gICAgICBuZXcgTm90aWNlKFxyXG4gICAgICAgIFwiT2JzaWRpYW4gUmV3YXJkcyBjb3VsZG4ndCBvcGVuIHRoZSByZXdhcmRzIGZpbGUuXFxuUGxlYXNlIGNoZWNrIHRoZSBwYXRoIGluIHRoZSBzZXR0aW5ncy5cIlxyXG4gICAgICApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IGNvbnRlbnRzO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnRlbnRzID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChyZXdhcmRzRmlsZSk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgbmV3IE5vdGljZShcclxuICAgICAgICBcIk9ic2lkaWFuIFJld2FyZHMgY291bGRuJ3Qgb3BlbiB0aGUgcmV3YXJkcyBmaWxlLlxcblBsZWFzZSBjaGVjayB0aGUgcGF0aCBpbiB0aGUgc2V0dGluZ3MuXCJcclxuICAgICAgKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdmFyIGNoYXIgPSBcIlxcblwiO1xyXG4gICAgbGV0IHggPSAwO1xyXG4gICAgbGV0IHkgPSAwO1xyXG4gICAgbGV0IGRpcnR5UmV3YXJkcyA9IFtdO1xyXG5cclxuICAgIHdoaWxlICgoeSA9IGNvbnRlbnRzLmluZGV4T2YoY2hhciwgeCkpICE9PSAtMSkge1xyXG4gICAgICBkaXJ0eVJld2FyZHMucHVzaChjb250ZW50cy5zdWJzdHJpbmcoeCwgeSkpO1xyXG4gICAgICB4ID0geSArIDE7XHJcbiAgICB9XHJcbiAgICBkaXJ0eVJld2FyZHMucHVzaChjb250ZW50cy5zdWJzdHJpbmcoeCkpO1xyXG5cclxuICAgIC8vIENyZWF0ZSByZXdhcmRzIHdpdGggbWV0YWRhdGFcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGlydHlSZXdhcmRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IGRpcnR5UmV3YXJkID0gZGlydHlSZXdhcmRzW2ldO1xyXG5cclxuICAgICAgbGV0IHJld2FyZHNMZWZ0ID0gMTtcclxuICAgICAgbGV0IG9jY3VycmVuY2UgPSB0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1swXS5sYWJlbDtcclxuICAgICAgbGV0IHJld2FyZE5hbWUgPSBcIlwiO1xyXG4gICAgICBsZXQgaW1hZ2VMaW5rID0gXCJcIjtcclxuICAgICAgbGV0IG1ldGFkYXRhVmFsdWVzID0gW107XHJcbiAgICAgIGxldCBtZXRhZGF0YVN0YXJ0ID0gW107XHJcbiAgICAgIGxldCBtZXRhZGF0YUVuZCA9IFtdO1xyXG4gICAgICBsZXQgZGlydHlSZXdhcmRXaXRoUGFydGlhbE1ldGFkYXRhU3RyaXBwZWQgPSBkaXJ0eVJld2FyZDtcclxuXHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNDsgaSsrKSB7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBtZXRhZGF0YVxyXG4gICAgICAgIG1ldGFkYXRhU3RhcnRbaV0gPSBkaXJ0eVJld2FyZFdpdGhQYXJ0aWFsTWV0YWRhdGFTdHJpcHBlZC5pbmRleE9mKFxyXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJCZWdpblxyXG4gICAgICAgICk7XHJcbiAgICAgICAgbWV0YWRhdGFFbmRbaV0gPSBkaXJ0eVJld2FyZFdpdGhQYXJ0aWFsTWV0YWRhdGFTdHJpcHBlZC5pbmRleE9mKFxyXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJFbmQsXHJcbiAgICAgICAgICBtZXRhZGF0YVN0YXJ0W2ldXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAobWV0YWRhdGFTdGFydFtpXSA8IDApIHtcclxuICAgICAgICAgIC8vIElmIGZpcnN0IG1ldGFkYXRhIG5vdCBmb3VuZCB0aGVuIHB1dCBkZWZhdWx0IHZhbHVlc1xyXG4gICAgICAgICAgcmV3YXJkTmFtZSA9IGRpcnR5UmV3YXJkV2l0aFBhcnRpYWxNZXRhZGF0YVN0cmlwcGVkO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG1ldGFkYXRhVmFsdWVzW2ldID0gZGlydHlSZXdhcmRXaXRoUGFydGlhbE1ldGFkYXRhU3RyaXBwZWQuc3Vic3RyaW5nKFxyXG4gICAgICAgICAgICBtZXRhZGF0YVN0YXJ0W2ldICsgMSxcclxuICAgICAgICAgICAgbWV0YWRhdGFFbmRbaV1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIG1ldGFkYXRhVmFsdWVzW2ldLnN1YnN0cmluZygwLCA2KSA9PT0gXCJhcHA6Ly9cIiB8fFxyXG4gICAgICAgICAgbWV0YWRhdGFWYWx1ZXNbaV0uc3Vic3RyaW5nKDAsIDQpID09PSBcImh0dHBcIlxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgaW1hZ2VMaW5rID0gbWV0YWRhdGFWYWx1ZXNbaV07XHJcbiAgICAgICAgfSBlbHNlIGlmICgvXlxcZCskLy50ZXN0KG1ldGFkYXRhVmFsdWVzW2ldKSkge1xyXG4gICAgICAgICAgcmV3YXJkc0xlZnQgPSBwYXJzZUludChtZXRhZGF0YVZhbHVlc1tpXSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIG9jY3VycmVuY2UgPSBtZXRhZGF0YVZhbHVlc1tpXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGlydHlSZXdhcmRXaXRoUGFydGlhbE1ldGFkYXRhU3RyaXBwZWQgPVxyXG4gICAgICAgICAgZGlydHlSZXdhcmRXaXRoUGFydGlhbE1ldGFkYXRhU3RyaXBwZWQucmVwbGFjZShcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJCZWdpbiArXHJcbiAgICAgICAgICAgICAgbWV0YWRhdGFWYWx1ZXNbaV0gK1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kLFxyXG4gICAgICAgICAgICBcIlwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHJld2FyZE9iamVjdCA9IHtcclxuICAgICAgICBkaXJ0eVJld2FyZDogZGlydHlSZXdhcmRzW2ldLFxyXG4gICAgICAgIHJld2FyZE5hbWU6IHJld2FyZE5hbWUucmVwbGFjZSgvXFxufFxcdHxcXHJ8LSB8XFwqIHxcXCsgL2csIFwiXCIpLnRyaW0oKSxcclxuICAgICAgICByZXdhcmRzTGVmdDogcmV3YXJkc0xlZnQsXHJcbiAgICAgICAgb2NjdXJyZW5jZTogb2NjdXJyZW5jZSxcclxuICAgICAgICBpbWFnZUxpbms6IGltYWdlTGluayxcclxuICAgICAgfTtcclxuICAgICAgaWYgKHJld2FyZE9iamVjdC5yZXdhcmRzTGVmdCA+IDApIHtcclxuICAgICAgICAvLyBPbmx5IGFkZCByZXdhcmQgaWYgdGhlcmUgaXMgaW52ZW50b3J5XHJcbiAgICAgICAgYXJyYXlPZkNsZWFuZWRSZXdhcmRzLnB1c2gocmV3YXJkT2JqZWN0KTtcclxuXHJcbiAgICAgICAgaWYgKHJld2FyZHNCeU9jY3VycmVuY2UuaGFzT3duUHJvcGVydHkob2NjdXJyZW5jZSkpIHtcclxuICAgICAgICAgIHJld2FyZHNCeU9jY3VycmVuY2Vbb2NjdXJyZW5jZV0ucHVzaChyZXdhcmRPYmplY3QpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXdhcmRzQnlPY2N1cnJlbmNlW29jY3VycmVuY2VdID0gW107XHJcbiAgICAgICAgICByZXdhcmRzQnlPY2N1cnJlbmNlW29jY3VycmVuY2VdLnB1c2gocmV3YXJkT2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBDaGVjayB3aGF0IHJld2FyZCB0eXBlcyBhcmUgYWN0aXZlIGFuZCBob3cgbWFueSBvZiBlYWNoLCBmb3IgY2hhbmNlIGNhbGN1bGF0aW9uXHJcblxyXG4gICAgbGV0IGZvdW5kT2NjdXJlbmNlVHlwZXMgPSB7XHJcbiAgICAgIFt0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1swXS5sYWJlbF06IDAsXHJcbiAgICAgIFt0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1sxXS5sYWJlbF06IDAsXHJcbiAgICAgIFt0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1syXS5sYWJlbF06IDAsXHJcbiAgICB9O1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheU9mQ2xlYW5lZFJld2FyZHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgZm91bmRPY2N1cmVuY2VUeXBlc1thcnJheU9mQ2xlYW5lZFJld2FyZHNbaV0ub2NjdXJyZW5jZV0gPVxyXG4gICAgICAgIGZvdW5kT2NjdXJlbmNlVHlwZXNbYXJyYXlPZkNsZWFuZWRSZXdhcmRzW2ldLm9jY3VycmVuY2VdICsgMTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZWUgaWYgd2Ugd29uIGEgcmV3YXJkXHJcblxyXG4gICAgbGV0IHN1bU9mT2NjdXJyZW5jZXMgPSAwO1xyXG5cclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKGZvdW5kT2NjdXJlbmNlVHlwZXNbdGhpcy5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWxdID4gMCkge1xyXG4gICAgICAgIHN1bU9mT2NjdXJyZW5jZXMgKz0gdGhpcy5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0udmFsdWU7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChzdW1PZk9jY3VycmVuY2VzID4gMTAwKSB7XHJcbiAgICAgIC8vIE5lZWQgdG8gY29udmVydCBzbyB0b3RhbCBpcyBubyBtb3JlIHRoYW4gMTAwJVxyXG4gICAgICBjb25zdCBkaXZpZGVCeVRoaXNUb0dldFRvMTAwID0gc3VtT2ZPY2N1cnJlbmNlcyAvIDEwMDtcclxuXHJcbiAgICAgIGZvciAoXHJcbiAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgIGkgPCBPYmplY3Qua2V5cyh0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlcykubGVuZ3RoO1xyXG4gICAgICAgIGkrK1xyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS52YWx1ZSA9XHJcbiAgICAgICAgICB0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS52YWx1ZSAvIGRpdmlkZUJ5VGhpc1RvR2V0VG8xMDA7XHJcbiAgICAgIH1cclxuICAgICAgc3VtT2ZPY2N1cnJlbmNlcyA9IHRoaXMuc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzLnJlZHVjZShcclxuICAgICAgICAocGFydGlhbFN1bSwgYSkgPT4gcGFydGlhbFN1bSArIGEsXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHN1bU9mT2NjdXJyZW5jZXMgPSBzdW1PZk9jY3VycmVuY2VzICogMTA7IC8vIFRvIHNraXAgZGVjaW1hbCBudW1iZXJzXHJcblxyXG4gICAgY29uc3QgbG90dGVyeU51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDEwMDApO1xyXG5cclxuICAgIGlmIChsb3R0ZXJ5TnVtYmVyID4gc3VtT2ZPY2N1cnJlbmNlcykge1xyXG4gICAgICAvLyBEaWQgbm90IGdldCBhIHJld2FyZCBidXQgc3RpbGwgY2hlY2sgaWYgd2Ugc2hvdWxkIGxvZ1xyXG4gICAgICB0aGlzLmxvZ1RvRGFpbHlOb3RlKGNsaWNrZWRUYXNrVGV4dCwge30sIHRydWUpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2V0IHRoZSByZXdhcmRcclxuXHJcbiAgICBjb25zdCBvYmplY3RPZk9jY3VycmVuY2VzID0ge307XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIG9iamVjdE9mT2NjdXJyZW5jZXNbdGhpcy5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWxdID1cclxuICAgICAgICB0aGlzLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS52YWx1ZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFycmF5T2ZPY2N1cnJlbmNlcyA9IE9iamVjdC5rZXlzKGZvdW5kT2NjdXJlbmNlVHlwZXMpO1xyXG5cclxuICAgIGxldCBjaGVja2VkUHJvYmFiaWxpdGllcyA9IDA7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnJheU9mT2NjdXJyZW5jZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGZvdW5kT2NjdXJlbmNlVHlwZXNbYXJyYXlPZk9jY3VycmVuY2VzW2ldXSA+IDAgJiZcclxuICAgICAgICBsb3R0ZXJ5TnVtYmVyIDxcclxuICAgICAgICAgIG9iamVjdE9mT2NjdXJyZW5jZXNbYXJyYXlPZk9jY3VycmVuY2VzW2ldXSAqIDEwICsgY2hlY2tlZFByb2JhYmlsaXRpZXNcclxuICAgICAgKSB7XHJcbiAgICAgICAgLy8gQ2hvb3NlIGEgcmV3YXJkIGFtb25nIHRoZSBvbmVzIHdpdGhpbiB0aGUgc2FtZSBvY2N1cnJlbmNlIGNhdGVnb3J5XHJcbiAgICAgICAgY29uc3QgcmFuZG9tTnVtYmVyVG9DaG9vc2VSZXdhcmRXaXRoaW5PY2N1cmVuY2UgPSBNYXRoLmZsb29yKFxyXG4gICAgICAgICAgTWF0aC5yYW5kb20oKSAqIGZvdW5kT2NjdXJlbmNlVHlwZXNbYXJyYXlPZk9jY3VycmVuY2VzW2ldXVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2hvc2VuUmV3YXJkID1cclxuICAgICAgICAgIHJld2FyZHNCeU9jY3VycmVuY2VbYXJyYXlPZk9jY3VycmVuY2VzW2ldXVtcclxuICAgICAgICAgICAgcmFuZG9tTnVtYmVyVG9DaG9vc2VSZXdhcmRXaXRoaW5PY2N1cmVuY2VcclxuICAgICAgICAgIF07XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgICAgY2hlY2tlZFByb2JhYmlsaXRpZXMgPVxyXG4gICAgICAgIGNoZWNrZWRQcm9iYWJpbGl0aWVzICsgb2JqZWN0T2ZPY2N1cnJlbmNlc1thcnJheU9mT2NjdXJyZW5jZXNbaV1dICogMTA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2hvdyBub3RpZmljYXRpb25cclxuXHJcbiAgICBsZXQgbW9kaWZpZXI7XHJcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5zaG93TW9kYWwpIHtcclxuICAgICAgbW9kaWZpZXIgPSBhd2FpdCBkaXNwbGF5TW9kYWwodGhpcy5hcHAsIGNob3NlblJld2FyZCwgdGhpcy5zZXR0aW5ncyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBzdHJpbmdUb1Nob3cgPSB0aGlzLnNldHRpbmdzLnVzZUFzSW5zcGlyYXRpb25hbFxyXG4gICAgICAgID8gY2hvc2VuUmV3YXJkLnJld2FyZE5hbWVcclxuICAgICAgICA6IFwiXHVEODNDXHVERjg4IFx1RDgzQ1x1REY4OSBcdUQ4M0NcdURGODggQ29uZ3JhdHVsYXRpb25zISBcdUQ4M0NcdURGODggXHVEODNDXHVERjg5IFx1RDgzQ1x1REY4OFxcbkJ5IGNvbXBsZXRpbmcgdGhpcyB0YXNrIHlvdSB3b24gdGhpcyByZXdhcmQ6XFxuIFwiICtcclxuICAgICAgICAgIFwiXHUyQjUwIFwiICtcclxuICAgICAgICAgIGNob3NlblJld2FyZC5yZXdhcmROYW1lICtcclxuICAgICAgICAgIFwiIFx1MkI1MFwiO1xyXG4gICAgICBuZXcgTm90aWNlKHN0cmluZ1RvU2hvdyk7XHJcbiAgICB9XHJcbiAgICAvLyBTdWJzdHJhY3QgcmV3YXJkIHF1YW50aXR5XHJcblxyXG4gICAgbGV0IGFkanVzdGVkUmV3YXJkO1xyXG5cclxuICAgIGlmIChjaG9zZW5SZXdhcmQucmV3YXJkc0xlZnQpIHtcclxuICAgICAgbGV0IG5ld1Jld2FyZHNMZWZ0ID1cclxuICAgICAgICBwYXJzZUludChjaG9zZW5SZXdhcmQucmV3YXJkc0xlZnQpICsgcGFyc2VJbnQobW9kaWZpZXIpO1xyXG4gICAgICBhZGp1c3RlZFJld2FyZCA9IGNob3NlblJld2FyZC5kaXJ0eVJld2FyZC5yZXBsYWNlKFxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gK1xyXG4gICAgICAgICAgY2hvc2VuUmV3YXJkLnJld2FyZHNMZWZ0ICtcclxuICAgICAgICAgIHRoaXMuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kLFxyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gK1xyXG4gICAgICAgICAgbmV3UmV3YXJkc0xlZnQgK1xyXG4gICAgICAgICAgdGhpcy5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJFbmRcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGFkanVzdGVkUmV3YXJkID0gY2hvc2VuUmV3YXJkLmRpcnR5UmV3YXJkO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSByZXdhcmRzIGZpbGVcclxuXHJcbiAgICBsZXQgbmV3Q29udGVudHMgPSBjb250ZW50cy5yZXBsYWNlKFxyXG4gICAgICBjaG9zZW5SZXdhcmQuZGlydHlSZXdhcmQsXHJcbiAgICAgIGFkanVzdGVkUmV3YXJkXHJcbiAgICApO1xyXG4gICAgdHJ5IHtcclxuICAgICAgdmF1bHQubW9kaWZ5KHJld2FyZHNGaWxlLCBuZXdDb250ZW50cyk7XHJcbiAgICB9IGNhdGNoIHtcclxuICAgICAgbmV3IE5vdGljZShcIk9ic2lkaWFuIFJld2FyZHMgY291bGRuJ3QgbW9kaWZ5IHRoZSByZXdhcmRzIGZpbGUuXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubG9nVG9EYWlseU5vdGUoY2xpY2tlZFRhc2tUZXh0LCBjaG9zZW5SZXdhcmQsIGZhbHNlKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIGxvZ1RvRGFpbHlOb3RlKGNsaWNrZWRUYXNrVGV4dCwgY2hvc2VuUmV3YXJkLCBsb2dUYXNrT25seSkge1xyXG4gICAgLy8gTG9nIHRvIGRhaWx5IG5vdGUsIHBhcnRseSB0YWtlbiBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9remhvdm4vc3RhdHVzYmFyLXBvbW8tb2JzaWRpYW4vYmxvYi9tYXN0ZXIvc3JjL3RpbWVyLnRzXHJcblxyXG4gICAgbGV0IGxvZ1Rhc2tzVGV4dCA9IHRoaXMuc2V0dGluZ3Muc2F2ZVRhc2tUb0RhaWx5XHJcbiAgICAgID8gdGhpcy5zZXR0aW5ncy5jb21wbGV0ZWRUYXNrQ2hhcmFjdGVyICtcclxuICAgICAgICBjbGlja2VkVGFza1RleHQgK1xyXG4gICAgICAgIFwiIChbW1wiICtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLmJhc2VuYW1lICtcclxuICAgICAgICBcIl1dKVwiICtcclxuICAgICAgICBcIiAtIFwiICtcclxuICAgICAgICBtb21lbnQoKS5mb3JtYXQoXCJISDptbVwiKVxyXG4gICAgICA6IFwiXCI7XHJcblxyXG4gICAgbGV0IGxvZ1Jld2FyZHNUZXh0ID1cclxuICAgICAgKHRoaXMuc2V0dGluZ3Muc2F2ZVJld2FyZFRvRGFpbHkgJiYgbG9nVGFza09ubHkgPT09IGZhbHNlXHJcbiAgICAgICAgPyBcIkVhcm5lZCByZXdhcmQ6IFwiICtcclxuICAgICAgICAgIGNob3NlblJld2FyZC5yZXdhcmROYW1lXHJcbiAgICAgICAgOiBcIlwiKTtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgICh0aGlzLnNldHRpbmdzLnNhdmVSZXdhcmRUb0RhaWx5ID09PSB0cnVlIHx8IHRoaXMuc2V0dGluZ3Muc2F2ZVRhc2tUb0RhaWx5ID09PSB0cnVlKSAmJlxyXG4gICAgICBhcHBIYXNEYWlseU5vdGVzUGx1Z2luTG9hZGVkKCkgPT09IHRydWVcclxuICAgICkge1xyXG4gICAgICBsZXQgZmlsZSA9IChhd2FpdCBnZXREYWlseU5vdGVGaWxlKCkpLnBhdGg7XHJcbiAgICAgIC8vZnJvbSBOb3RlIFJlZmFjdG9yIHBsdWdpbiBieSBKYW1lcyBMeW5jaCwgaHR0cHM6Ly9naXRodWIuY29tL2x5bmNoamFtZXMvbm90ZS1yZWZhY3Rvci1vYnNpZGlhbi9ibG9iLzgwYzFhMjNhMTM1MmI1ZDIyYzcwZjFiMWQ5MTViNGUwYTFiMmIzM2Yvc3JjL29ic2lkaWFuLWZpbGUudHMjTDY5XHJcblxyXG4gICAgICBsZXQgZXhpc3RpbmdDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5yZWFkKGZpbGUpO1xyXG4gICAgICBpZiAoZXhpc3RpbmdDb250ZW50Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5zYXZlVGFza1RvRGFpbHkpIHtcclxuICAgICAgICAgIGNvbnN0IHNhdmVUYXNrU2VjdGlvbkhlYWRpbmcgPSB0aGlzLnNldHRpbmdzLnNhdmVUYXNrU2VjdGlvbkhlYWRpbmc7XHJcbiAgICAgICAgICBpZiAoc2F2ZVRhc2tTZWN0aW9uSGVhZGluZykge1xyXG4gICAgICAgICAgICAvLyBmcm9tIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY2NjE2MDY1L21hcmtkb3duLXJlZ2V4LXRvLWZpbmQtYWxsLWNvbnRlbnQtZm9sbG93aW5nLWFuLWhlYWRpbmctMi1idXQtc3RvcC1hdC1hbm90aGVyXHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXMgPSBleGlzdGluZ0NvbnRlbnQubWF0Y2gobmV3IFJlZ0V4cChcIig/Ol58XFxuKVwiICsgc2F2ZVRhc2tTZWN0aW9uSGVhZGluZyArIFwiW15cXG5dKlxcbi4qPyg/PVxcbiojIz9cXHM/fCQpXCIsICdncycpKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBtYXRjaGVzWzBdO1xyXG4gICAgICAgICAgICAgIGV4aXN0aW5nQ29udGVudCA9IGV4aXN0aW5nQ29udGVudC5yZXBsYWNlKG1hdGNoLCBtYXRjaCArIFwiXFxuXCIgKyBsb2dUYXNrc1RleHQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIGV4aXN0aW5nQ29udGVudCA9IGV4aXN0aW5nQ29udGVudCArIFwiXFxuXCIgKyBsb2dUYXNrc1RleHQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGV4aXN0aW5nQ29udGVudCA9IGV4aXN0aW5nQ29udGVudCArIFwiXFxuXCIgKyBsb2dUYXNrc1RleHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5zYXZlUmV3YXJkVG9EYWlseSAmJiBsb2dUYXNrT25seSA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgIGNvbnN0IHNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZyA9IHRoaXMuc2V0dGluZ3Muc2F2ZVJld2FyZFNlY3Rpb25IZWFkaW5nO1xyXG4gICAgICAgICAgaWYgKHNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZykge1xyXG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gZXhpc3RpbmdDb250ZW50Lm1hdGNoKG5ldyBSZWdFeHAoXCIoPzpefFxcbilcIiArIHNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZyArIFwiW15cXG5dKlxcbi4qPyg/PVxcbiojIz9cXHM/fCQpXCIsICdncycpKTtcclxuICAgICAgICAgICAgaWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSBtYXRjaGVzWzBdO1xyXG4gICAgICAgICAgICAgIGV4aXN0aW5nQ29udGVudCA9IGV4aXN0aW5nQ29udGVudC5yZXBsYWNlKG1hdGNoLCBtYXRjaCArIFwiXFxuXCIgKyBsb2dSZXdhcmRzVGV4dCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgZXhpc3RpbmdDb250ZW50ID0gZXhpc3RpbmdDb250ZW50ICsgXCJcXG5cIiArIGxvZ1Jld2FyZHNUZXh0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBleGlzdGluZ0NvbnRlbnQgPSBleGlzdGluZ0NvbnRlbnQgKyBcIlxcblwiICsgbG9nUmV3YXJkc1RleHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLndyaXRlKGZpbGUsIGV4aXN0aW5nQ29udGVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBjcmVhdGVTYW1wbGVOb3RlKHNlbGYpIHtcclxuICAgIC8vIENyZWF0ZXMgYSBzYW1wbGUgbm90ZSBvZiByZXdhcmRzIHVzaW5nIHRoZSB1c2VyJ3Mgc2V0dGluZ3NcclxuICAgIGxldCBmb2xkZXIgPSBhcHAuZmlsZU1hbmFnZXIuZ2V0TmV3RmlsZVBhcmVudChcIlwiKTtcclxuICAgIGNvbnN0IGNyZWF0ZWROb3RlID0gYXdhaXQgYXBwLmZpbGVNYW5hZ2VyLmNyZWF0ZU5ld01hcmtkb3duRmlsZShcclxuICAgICAgZm9sZGVyLFxyXG4gICAgICBcIlJld2FyZHMubWRcIlxyXG4gICAgKTtcclxuICAgIGNvbnN0IHNhbXBsZUNvbnRlbnRzRm9yTm90ZSA9XHJcbiAgICAgIFwiLSBIYXZlIGEgY3VwIG9mIHRlYVwiICtcclxuICAgICAgXCJcXG4tIFdhdGNoIGFuIGVwaXNvZGUgb2YgZmF2b3VyaXRlIHNlcmllcyBcIiArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gK1xyXG4gICAgICBzZWxmLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1sxXS5sYWJlbCArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kICtcclxuICAgICAgXCIgXCIgK1xyXG4gICAgICBzZWxmLnNldHRpbmdzLmVzY2FwZUNoYXJhY3RlckJlZ2luICtcclxuICAgICAgXCIyMFwiICtcclxuICAgICAgc2VsZi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJFbmQgK1xyXG4gICAgICBcIlxcbi0gS25pdCBmb3IgMTUgbWludXRlcyBcIiArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gK1xyXG4gICAgICBzZWxmLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1sxXS5sYWJlbCArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kICtcclxuICAgICAgXCIgXCIgK1xyXG4gICAgICBcIlxcbi0gT3BlbiB0aGUgYmlydGhkYXkgcHJlc2VudCBjaGFtcGFnbmUgYm90dGxlIFwiICtcclxuICAgICAgc2VsZi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJCZWdpbiArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzWzJdLmxhYmVsICtcclxuICAgICAgc2VsZi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJFbmQgK1xyXG4gICAgICBcIiBcIiArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gK1xyXG4gICAgICBcIjFcIiArXHJcbiAgICAgIHNlbGYuc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kO1xyXG4gICAgYXBwLnZhdWx0Lm1vZGlmeShjcmVhdGVkTm90ZSwgc2FtcGxlQ29udGVudHNGb3JOb3RlKTtcclxuICAgIG5ldyBOb3RpY2UoXCJDcmVhdGVkIGZpbGUgXCIgKyBjcmVhdGVkTm90ZS5wYXRoKTtcclxuICB9XHJcblxyXG4gIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBPYnNpZGlhblJld2FyZGVyU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuXHJcbiAgICB0aGlzLmFkZENvbW1hbmQoe1xyXG4gICAgICBpZDogXCJjcmVhdGUtc2FtcGxlLXJld2FyZHMtbm90ZVwiLFxyXG4gICAgICBuYW1lOiBcIkNyZWF0ZSBzYW1wbGUgcmV3YXJkcyBub3RlXCIsXHJcbiAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVTYW1wbGVOb3RlKHRoaXMpO1xyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcblxyXG4gICAgbGV0IGNhbGxiYWNrID0gKGV2dDogRXZlbnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2dC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50ICYmXHJcbiAgICAgICAgZXZ0LnRhcmdldC50eXBlID09PSBcImNoZWNrYm94XCIgJiZcclxuICAgICAgICBldnQudGFyZ2V0LmNoZWNrZWQgJiZcclxuICAgICAgICAoZXZ0LnRhcmdldC5wYXJlbnROb2RlLmlubmVyVGV4dC5sZW5ndGggPiAwIHx8IGV2dC50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLmlubmVyVGV4dC5sZW5ndGggPiAwKVxyXG4gICAgICApIHtcclxuICAgICAgICBldnQudGFyZ2V0LnBhcmVudE5vZGUuaW5uZXJUZXh0Lmxlbmd0aCA+IDAgLy8gQ2hlY2sgd2hlcmUgdGFzayBuYW1lIGlzLCBkZXBlbmRzIG9uIGlmIGlzIHVzaW5nIE9ic2lkaWFuIFRhc2tzIG9yIG5vdFxyXG4gICAgICAgICAgPyB0aGlzLmhhbmRsZVJld2FyZChldnQudGFyZ2V0LnBhcmVudE5vZGUuaW5uZXJUZXh0KVxyXG4gICAgICAgICAgOiB0aGlzLmhhbmRsZVJld2FyZChldnQudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbm5lclRleHQpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2FsbGJhY2ssIHsgY2FwdHVyZTogdHJ1ZSB9KTsgLy8gQWRkaW5nIGxpa2UgdGhpcyBpbnN0ZWFkIG9mIHJlZ2lzdGVyRG9tRXZlbnQgYXMgY2FuJ3QgdXNlIHRoZSBcImNhcHR1cmVcIi1vcHRpb24gd2l0aCBpdC4gQ2FwdHVyZSBuZWVkZWQgYXMgT2JzaWRpYW4tdGFza3Mgc3RvcHMgcHJvcGFnYXRpb24uXHJcblxyXG4gICAgLy8gVGhpcyByZWdpc3RlcnMgdGhlIHVubG9hZCBmdW5jdGlvblxyXG4gICAgdGhpcy5yZWdpc3RlcigoKSA9PlxyXG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNhbGxiYWNrLCB7IGNhcHR1cmU6IHRydWUgfSlcclxuICAgICk7XHJcblxyXG4gICAgaWYgKHRoaXMuYXBwLndvcmtzcGFjZS5sYXlvdXRSZWFkeSkge1xyXG4gICAgICB0aGlzLm9uTGF5b3V0UmVhZHkoKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbihcImxheW91dC1yZWFkeVwiLCB0aGlzLm9uTGF5b3V0UmVhZHkuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkxheW91dFJlYWR5KCkge1xyXG4gICAgY29uc3QgdG9nZ2xlQ2hlY2tib3hTdGF0dXNDb21tYW5kID0gdGhpcy5hcHAuY29tbWFuZHMuZmluZENvbW1hbmQoXCJlZGl0b3I6dG9nZ2xlLWNoZWNrbGlzdC1zdGF0dXNcIik7XHJcbiAgICBjb25zdCB0aGF0ID0gdGhpcztcclxuICAgIGFyb3VuZCh0b2dnbGVDaGVja2JveFN0YXR1c0NvbW1hbmQsIHtcclxuICAgICAgZWRpdG9yQ2FsbGJhY2s6IChuZXh0KSA9PiBmdW5jdGlvbihlZGl0b3I6IEVkaXRvcikge1xyXG4gICAgICAgIG5leHQuY2FsbCh0aGlzLCBlZGl0b3IpO1xyXG4gICAgICAgIGxldCBjdXJzb3IgPSBlZGl0b3IuZ2V0Q3Vyc29yKCk7XHJcbiAgICAgICAgbGV0IGxpbmVUZXh0ID0gZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpO1xyXG5cclxuICAgICAgICBjb25zdCBpZHggPSBsaW5lVGV4dC5zZWFyY2goLy0gXFxbeFxcXSAvKTsgLy8gb25seSBjaGVja2VkIHN0YXR1c1xyXG4gICAgICAgIGlmIChpZHggPj0gMCkge1xyXG4gICAgICAgICAgY29uc3QgY2hlY2tlZFRhc2tUZXh0ID0gbGluZVRleHQuc3Vic3RyaW5nKGlkeCArIDYpO1xyXG4gICAgICAgICAgdGhhdC5oYW5kbGVSZXdhcmQoY2hlY2tlZFRhc2tUZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRpc3BsYXlNb2RhbChcclxuICBhcHA6IEFwcCxcclxuICByZXdhcmRPYmplY3Q6IGFueSxcclxuICBzZXR0aW5nczogYW55XHJcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBtb2RhbCA9IG5ldyBDb25ncmF0dWxhdGlvbnNNb2RhbChhcHAsIHJld2FyZE9iamVjdCwgc2V0dGluZ3MpO1xyXG4gICAgICBtb2RhbC5vbkNsb3NlID0gKCkgPT4ge1xyXG4gICAgICAgIHJlc29sdmUobW9kYWwubW9kaWZpZXIpO1xyXG4gICAgICB9O1xyXG4gICAgICBtb2RhbC5vcGVuKCk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIHJlamVjdCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG5jbGFzcyBDb25ncmF0dWxhdGlvbnNNb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHVibGljIHJld2FyZE9iamVjdDogYW55LCBwdWJsaWMgc2V0dGluZ3M6IGFueSkge1xyXG4gICAgc3VwZXIoYXBwKTtcclxuICB9XHJcblxyXG4gIG1vZGlmaWVyOiBudW1iZXIgPSAtMTtcclxuXHJcbiAgb25PcGVuKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwsIGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgY29uc3QgbW9kYWwgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwicmV3YXJkZXJNb2RhbFwiIH0pO1xyXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlQXNJbnNwaXJhdGlvbmFsKSB7XHJcbiAgICAgIG1vZGFsLmNyZWF0ZUVsKFwiaDFcIiwge1xyXG4gICAgICAgIHRleHQ6IHRoaXMucmV3YXJkT2JqZWN0LnJld2FyZE5hbWUsXHJcbiAgICAgIH0pO1xyXG4gICAgICBtb2RhbC5jcmVhdGVFbChcImltZ1wiLCB7XHJcbiAgICAgICAgYXR0cjoge1xyXG4gICAgICAgICAgc3JjOiB0aGlzLnJld2FyZE9iamVjdC5pbWFnZUxpbmssXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBtb2RhbC5jcmVhdGVFbChcImgyXCIsIHtcclxuICAgICAgICB0ZXh0OiBcIkNvbmdyYXR1bGF0aW9ucyFcIixcclxuICAgICAgfSk7XHJcbiAgICAgIG1vZGFsLmNyZWF0ZUVsKFwicFwiLCB7XHJcbiAgICAgICAgdGV4dDogXCJCeSBjb21wbGV0aW5nIHRoaXMgdGFzayB5b3Ugd29uIHRoaXMgcmV3YXJkOlwiLFxyXG4gICAgICB9KTtcclxuICAgICAgbW9kYWwuY3JlYXRlRWwoXCJoMVwiLCB7XHJcbiAgICAgICAgdGV4dDogXCJcdTJCNTAgXCIgKyB0aGlzLnJld2FyZE9iamVjdC5yZXdhcmROYW1lICsgXCIgXHUyQjUwXCIsXHJcbiAgICAgICAgY2xzOiBcInJld2FyZE5hbWVcIixcclxuICAgICAgfSk7XHJcbiAgICAgIG1vZGFsLmNyZWF0ZUVsKFwiaW1nXCIsIHtcclxuICAgICAgICBhdHRyOiB7XHJcbiAgICAgICAgICBzcmM6IHRoaXMucmV3YXJkT2JqZWN0LmltYWdlTGluayxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgICAgbW9kYWwuY3JlYXRlRWwoXCJoMlwiLCB7XHJcbiAgICAgICAgdGV4dDogXCJcdUQ4M0NcdURGODggXHVEODNDXHVERjg5IFx1RDgzQ1x1REY4OFwiLFxyXG4gICAgICB9KTtcclxuICAgICAgbW9kYWxcclxuICAgICAgICAuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG4gICAgICAgICAgYXR0cjogeyB0eXBlOiBcImJ1dHRvblwiIH0sXHJcbiAgICAgICAgICB0ZXh0OiBcIlNraXAgdGhpcyByZXdhcmRcIixcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5tb2RpZmllciA9IDA7XHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkNsb3NlKCkge1xyXG4gICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICB9XHJcbn1cclxuIiwgImV4cG9ydCBmdW5jdGlvbiBhcm91bmQob2JqLCBmYWN0b3JpZXMpIHtcbiAgICBjb25zdCByZW1vdmVycyA9IE9iamVjdC5rZXlzKGZhY3RvcmllcykubWFwKGtleSA9PiBhcm91bmQxKG9iaiwga2V5LCBmYWN0b3JpZXNba2V5XSkpO1xuICAgIHJldHVybiByZW1vdmVycy5sZW5ndGggPT09IDEgPyByZW1vdmVyc1swXSA6IGZ1bmN0aW9uICgpIHsgcmVtb3ZlcnMuZm9yRWFjaChyID0+IHIoKSk7IH07XG59XG5mdW5jdGlvbiBhcm91bmQxKG9iaiwgbWV0aG9kLCBjcmVhdGVXcmFwcGVyKSB7XG4gICAgY29uc3Qgb3JpZ2luYWwgPSBvYmpbbWV0aG9kXSwgaGFkT3duID0gb2JqLmhhc093blByb3BlcnR5KG1ldGhvZCk7XG4gICAgbGV0IGN1cnJlbnQgPSBjcmVhdGVXcmFwcGVyKG9yaWdpbmFsKTtcbiAgICAvLyBMZXQgb3VyIHdyYXBwZXIgaW5oZXJpdCBzdGF0aWMgcHJvcHMgZnJvbSB0aGUgd3JhcHBpbmcgbWV0aG9kLFxuICAgIC8vIGFuZCB0aGUgd3JhcHBpbmcgbWV0aG9kLCBwcm9wcyBmcm9tIHRoZSBvcmlnaW5hbCBtZXRob2RcbiAgICBpZiAob3JpZ2luYWwpXG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihjdXJyZW50LCBvcmlnaW5hbCk7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHdyYXBwZXIsIGN1cnJlbnQpO1xuICAgIG9ialttZXRob2RdID0gd3JhcHBlcjtcbiAgICAvLyBSZXR1cm4gYSBjYWxsYmFjayB0byBhbGxvdyBzYWZlIHJlbW92YWxcbiAgICByZXR1cm4gcmVtb3ZlO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICAvLyBJZiB3ZSBoYXZlIGJlZW4gZGVhY3RpdmF0ZWQgYW5kIGFyZSBubyBsb25nZXIgd3JhcHBlZCwgcmVtb3ZlIG91cnNlbHZlc1xuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwgJiYgb2JqW21ldGhvZF0gPT09IHdyYXBwZXIpXG4gICAgICAgICAgICByZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnQuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIHJlbW92ZSgpIHtcbiAgICAgICAgLy8gSWYgbm8gb3RoZXIgcGF0Y2hlcywganVzdCBkbyBhIGRpcmVjdCByZW1vdmFsXG4gICAgICAgIGlmIChvYmpbbWV0aG9kXSA9PT0gd3JhcHBlcikge1xuICAgICAgICAgICAgaWYgKGhhZE93bilcbiAgICAgICAgICAgICAgICBvYmpbbWV0aG9kXSA9IG9yaWdpbmFsO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBvYmpbbWV0aG9kXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY3VycmVudCA9PT0gb3JpZ2luYWwpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIC8vIEVsc2UgcGFzcyBmdXR1cmUgY2FsbHMgdGhyb3VnaCwgYW5kIHJlbW92ZSB3cmFwcGVyIGZyb20gdGhlIHByb3RvdHlwZSBjaGFpblxuICAgICAgICBjdXJyZW50ID0gb3JpZ2luYWw7XG4gICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih3cmFwcGVyLCBvcmlnaW5hbCB8fCBGdW5jdGlvbik7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGRlZHVwZShrZXksIG9sZEZuLCBuZXdGbikge1xuICAgIGNoZWNrW2tleV0gPSBrZXk7XG4gICAgcmV0dXJuIGNoZWNrO1xuICAgIGZ1bmN0aW9uIGNoZWNrKC4uLmFyZ3MpIHtcbiAgICAgICAgcmV0dXJuIChvbGRGbltrZXldID09PSBrZXkgPyBvbGRGbiA6IG5ld0ZuKS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gYWZ0ZXIocHJvbWlzZSwgY2IpIHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGNiLCBjYik7XG59XG5leHBvcnQgZnVuY3Rpb24gc2VyaWFsaXplKGFzeW5jRnVuY3Rpb24pIHtcbiAgICBsZXQgbGFzdFJ1biA9IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGZ1bmN0aW9uIHdyYXBwZXIoLi4uYXJncykge1xuICAgICAgICByZXR1cm4gbGFzdFJ1biA9IG5ldyBQcm9taXNlKChyZXMsIHJlaikgPT4ge1xuICAgICAgICAgICAgYWZ0ZXIobGFzdFJ1biwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGFzeW5jRnVuY3Rpb24uYXBwbHkodGhpcywgYXJncykudGhlbihyZXMsIHJlaik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHdyYXBwZXIuYWZ0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBsYXN0UnVuID0gbmV3IFByb21pc2UoKHJlcywgcmVqKSA9PiB7IGFmdGVyKGxhc3RSdW4sIHJlcyk7IH0pO1xuICAgIH07XG4gICAgcmV0dXJuIHdyYXBwZXI7XG59XG4iLCAiaW1wb3J0IHtcclxuICBBcHAsXHJcbiAgZGVib3VuY2UsXHJcbiAgRWRpdG9yLFxyXG4gIE1hcmtkb3duVmlldyxcclxuICBNb2RhbCxcclxuICBOb3RpY2UsXHJcbiAgbm9ybWFsaXplUGF0aCxcclxuICBQbHVnaW4sXHJcbiAgUGx1Z2luU2V0dGluZ1RhYixcclxuICBTZXR0aW5nLFxyXG4gIFRvZ2dsZUNvbXBvbmVudCxcclxufSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgT2JzaWRpYW5SZXdhcmRlclNldHRpbmdzIHtcclxuICBjb21wbGV0ZWRUYXNrQ2hhcmFjdGVyOiBzdHJpbmc7XHJcbiAgZXNjYXBlQ2hhcmFjdGVyQmVnaW46IHN0cmluZztcclxuICBlc2NhcGVDaGFyYWN0ZXJFbmQ6IHN0cmluZztcclxuICBvY2N1cnJlbmNlVHlwZXM6IHtsYWJlbDogc3RyaW5nLCB2YWx1ZTogbnVtYmVyfVtdO1xyXG4gIHJld2FyZHNGaWxlOiBzdHJpbmc7XHJcbiAgc2F2ZVJld2FyZFRvRGFpbHk6IGJvb2xlYW47XHJcbiAgc2F2ZVJld2FyZFNlY3Rpb25IZWFkaW5nPzogc3RyaW5nO1xyXG4gIHNhdmVUYXNrVG9EYWlseTogYm9vbGVhbjtcclxuICBzYXZlVGFza1NlY3Rpb25IZWFkaW5nPzogc3RyaW5nO1xyXG4gIHNob3dNb2RhbDogYm9vbGVhbjtcclxuICB1c2VBc0luc3BpcmF0aW9uYWw6IGJvb2xlYW47XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBPYnNpZGlhblJld2FyZGVyU2V0dGluZ3MgPSB7XHJcbiAgY29tcGxldGVkVGFza0NoYXJhY3RlcjogXCJcdTI2MTFcdUZFMEZcIixcclxuICBlc2NhcGVDaGFyYWN0ZXJCZWdpbjogXCJ7XCIsXHJcbiAgZXNjYXBlQ2hhcmFjdGVyRW5kOiBcIn1cIixcclxuICBvY2N1cnJlbmNlVHlwZXM6IFtcclxuICAgIHsgbGFiZWw6IFwiY29tbW9uXCIsIHZhbHVlOiAyMCB9LFxyXG4gICAgeyBsYWJlbDogXCJyYXJlXCIsIHZhbHVlOiA1IH0sXHJcbiAgICB7IGxhYmVsOiBcImxlZ2VuZGFyeVwiLCB2YWx1ZTogMC41IH0sXHJcbiAgXSxcclxuICByZXdhcmRzRmlsZTogXCJSZXdhcmRzLm1kXCIsXHJcbiAgc2F2ZVJld2FyZFRvRGFpbHk6IGZhbHNlLFxyXG4gIHNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZzogdW5kZWZpbmVkLFxyXG4gIHNhdmVUYXNrVG9EYWlseTogZmFsc2UsXHJcbiAgc2F2ZVRhc2tTZWN0aW9uSGVhZGluZzogdW5kZWZpbmVkLFxyXG4gIHNob3dNb2RhbDogdHJ1ZSxcclxuICB1c2VBc0luc3BpcmF0aW9uYWw6IGZhbHNlLFxyXG59O1xyXG5cclxuaW1wb3J0IE9ic2lkaWFuUmV3YXJkZXIgZnJvbSBcIi4vbWFpblwiXHJcblxyXG5leHBvcnQgY2xhc3MgT2JzaWRpYW5SZXdhcmRlclNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBPYnNpZGlhblJld2FyZGVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBPYnNpZGlhblJld2FyZGVyKSB7XHJcbiAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIHNhbml0aXNlTm90ZSh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XHJcbiAgICAvLyBUYWtlbiBmcm9tIGhvbWVwYWdlIHBsdWdpblxyXG4gICAgaWYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlLm1hdGNoKC9eXFxzKiQvKSAhPT0gbnVsbCkge1xyXG4gICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuICAgIHJldHVybiBub3JtYWxpemVQYXRoKHZhbHVlKTtcclxuICB9XHJcblxyXG4gIGRpc3BsYXkoKTogdm9pZCB7XHJcbiAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cclxuICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgLy8gU2V0dGluZ3MgZm9yIGZ1bmN0aW9uYWxpdHlcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJGdW5jdGlvbmFsaXR5IHNldHRpbmdzXCIgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJGaWxlIHdpdGggUmV3YXJkc1wiKVxyXG4gICAgICAuc2V0RGVzYygnRm9yIGV4YW1wbGUgXCJSZXdhcmRzLm1kXCIgb3IgXCJGb2xkZXIvUmV3YXJkcy5tZFwiJylcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcclxuICAgICAgICB0ZXh0XHJcbiAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoREVGQVVMVF9TRVRUSU5HUy5yZXdhcmRzRmlsZSlcclxuICAgICAgICAgIC5zZXRWYWx1ZShcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmV3YXJkc0ZpbGUubGVuZ3RoID4gMFxyXG4gICAgICAgICAgICAgID8gdGhpcy5wbHVnaW4uc2V0dGluZ3MucmV3YXJkc0ZpbGVcclxuICAgICAgICAgICAgICA6IFwiXCJcclxuICAgICAgICAgIClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmV3YXJkc0ZpbGUgPVxyXG4gICAgICAgICAgICAgIHRoaXMuc2FuaXRpc2VOb3RlKHZhbHVlKSB8fCBERUZBVUxUX1NFVFRJTkdTLnJld2FyZHNGaWxlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNob3cgcG9wdXAgd2hlbiByZXdhcmQgaXMgYXdhcmRlZFwiKVxyXG4gICAgICAuc2V0RGVzYyhcIklmIGRpc2FibGVkIGEgbGVzcyBwcm9taW5lbnQgbm90aWNlIHdpbGwgYmUgc2hvd24gaW5zdGVhZFwiKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd01vZGFsKTtcclxuICAgICAgICB0b2dnbGUub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93TW9kYWwgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNhdmUgcmV3YXJkcyBpbiBkYWlseSBub3RlXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2lsbCBzYXZlIHJld2FyZHMgcmVjZWl2ZWQgdG8gdGhlIGVuZCBvZiB0aGUgZGFpbHkgbm90ZSBvciBzZWN0aW9uIGhlYWRpbmcgc3BlY2lmaWVkIGJlbG93XCIpXHJcbiAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xyXG4gICAgICAgIHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zYXZlUmV3YXJkVG9EYWlseSk7XHJcbiAgICAgICAgdG9nZ2xlLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVJld2FyZFRvRGFpbHkgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJUaGUgc2VjdGlvbiBoZWFkaW5nIG9mIGRhaWx5IG5vdGUgdXNlZCB0byBzYXZlIHJld2FyZHNcIilcclxuICAgICAgLnNldERlc2MoXHJcbiAgICAgICAgXCJUaGlzIHNlY3Rpb24gaGVhZGluZyBpcyB1c2VkIGFzIHRoZSBwbGFjZSBmb3Igc2F2aW5nIHJld2FyZHMgcmVjZWl2ZWQgaW4gdGhlIGRhaWx5IG5vdGVcIlxyXG4gICAgICApXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIiMjIFJld2FyZHNcIilcclxuICAgICAgICAgIC5zZXRWYWx1ZShcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVJld2FyZFNlY3Rpb25IZWFkaW5nXHJcbiAgICAgICAgICAgICAgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5zYXZlUmV3YXJkU2VjdGlvbkhlYWRpbmdcclxuICAgICAgICAgICAgICA6IFwiXCIpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwICYmIHZhbHVlLm1hdGNoKC9eIysvKSkge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEljb24oXCJyZXNldFwiKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVJld2FyZFNlY3Rpb25IZWFkaW5nID1cclxuICAgICAgICAgICAgICBERUZBVUxUX1NFVFRJTkdTLnNhdmVSZXdhcmRTZWN0aW9uSGVhZGluZztcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlNhdmUgdGFzayBpbiBkYWlseSBub3RlXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiV2lsbCBzYXZlIGNvbXBsZXRlZCB0YXNrcyB0byB0aGUgZW5kIG9mIHRoZSBkYWlseSBub3RlIG9yIHNlY3Rpb24gaGVhZGluZyBzcGVjaWZpZWQgYmVsb3dcIilcclxuICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcbiAgICAgICAgdG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNhdmVUYXNrVG9EYWlseSk7XHJcbiAgICAgICAgdG9nZ2xlLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVRhc2tUb0RhaWx5ID0gdmFsdWU7XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiVGhlIHNlY3Rpb24gaGVhZGluZyBvZiBkYWlseSBub3RlIHVzZWQgdG8gc2F2ZSB0YXNrc1wiKVxyXG4gICAgICAuc2V0RGVzYyhcclxuICAgICAgICBcIlRoaXMgc2VjdGlvbiBoZWFkaW5nIGlzIHVzZWQgYXMgdGhlIHBsYWNlIGZvciBzYXZpbmcgdGhlIGNvbXBsZXRlZCB0YXNrcyBpbiB0aGUgZGFpbHkgbm90ZVwiXHJcbiAgICAgIClcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiIyMgQ29tcGxldGVkVGFza3NcIilcclxuICAgICAgICAgIC5zZXRWYWx1ZShcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVRhc2tTZWN0aW9uSGVhZGluZ1xyXG4gICAgICAgICAgICAgID8gdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVRhc2tTZWN0aW9uSGVhZGluZ1xyXG4gICAgICAgICAgICAgIDogXCJcIilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDAgJiYgdmFsdWUubWF0Y2goL14jKy8pKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVRhc2tTZWN0aW9uSGVhZGluZyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEljb24oXCJyZXNldFwiKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2F2ZVRhc2tTZWN0aW9uSGVhZGluZyA9XHJcbiAgICAgICAgICAgICAgREVGQVVMVF9TRVRUSU5HUy5zYXZlVGFza1NlY3Rpb25IZWFkaW5nO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXHJcbiAgICAgIC5zZXROYW1lKFwiVXNlIHdpdGggcXVvdGVzIGluc3RlYWQgb2YgcmV3YXJkc1wiKVxyXG4gICAgICAuc2V0RGVzYyhcclxuICAgICAgICBcIlJld2FyZHMgYXJlIHNob3duIGFzIGluc3BpcmF0aW9uYWwgcXVvdGVzIGluc3RlYWQgb2YgY29uZ3JhdHVsYXRpb25zXCJcclxuICAgICAgKVxyXG4gICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcclxuICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlQXNJbnNwaXJhdGlvbmFsKTtcclxuICAgICAgICB0b2dnbGUub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VBc0luc3BpcmF0aW9uYWwgPSB2YWx1ZTtcclxuICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJSZXdhcmQgc2V0dGluZ3NcIiB9KTtcclxuXHJcbiAgICAvLyBTZXR0aW5ncyBmb3Igb2NjdXJlbmNlXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7XHJcbiAgICAgIHRleHQ6IFwiT2NjdXJyZW5jZSB2YWx1ZXNcIixcclxuICAgIH0pO1xyXG5cclxuICAgIGZvciAoXHJcbiAgICAgIGxldCBpID0gMDtcclxuICAgICAgaSA8IE9iamVjdC5rZXlzKHRoaXMucGx1Z2luLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlcykubGVuZ3RoO1xyXG4gICAgICBpKytcclxuICAgICkge1xyXG4gICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAuc2V0TmFtZShcclxuICAgICAgICAgIFwiSG93IG9mdGVuIHNob3VsZCBcIiArXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS5sYWJlbCArXHJcbiAgICAgICAgICAgIFwiIHJld2FyZHMgb2NjdXI/XCJcclxuICAgICAgICApXHJcbiAgICAgICAgLnNldERlc2MoXHJcbiAgICAgICAgICBcIkJldHdlZW4gMC4xJSB0byAxMDAlIGZvciBldmVyeSBmaW5pc2hlZCB0YXNrXCIgK1xyXG4gICAgICAgICAgICAoaSA9PT0gMCA/IFwiLiBUaGlzIGlzIHRoZSBkZWZhdWx0IHZhbHVlIGZvciByZXdhcmRzXCIgOiBcIlwiKVxyXG4gICAgICAgIClcclxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG4gICAgICAgICAgdGV4dC5pbnB1dEVsLnR5cGUgPSBcIm51bWJlclwiO1xyXG4gICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzW2ldLnZhbHVlKVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzW2ldLnZhbHVlLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodGV4dDogc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHZhbHVlID0gcGFyc2VGbG9hdCh0ZXh0KTtcclxuICAgICAgICAgICAgICAgIGxldCByZWZyZXNoRGlzcGxheSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMTAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gMTAwO1xyXG4gICAgICAgICAgICAgICAgICByZWZyZXNoRGlzcGxheSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlIDwgMC4xKSB7XHJcbiAgICAgICAgICAgICAgICAgIHZhbHVlID0gMC4xO1xyXG4gICAgICAgICAgICAgICAgICByZWZyZXNoRGlzcGxheSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0udmFsdWUgPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVmcmVzaERpc3BsYXkpIHtcclxuICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgICAgYnV0dG9uXHJcbiAgICAgICAgICAgIC5zZXRJY29uKFwicmVzZXRcIilcclxuICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS52YWx1ZSA9XHJcbiAgICAgICAgICAgICAgICBERUZBVUxUX1NFVFRJTkdTLm9jY3VycmVuY2VUeXBlc1tpXS52YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNldHRpbmdzIGZvciBvY2N1cmVuY2UgbGFiZWxzXHJcblxyXG4gICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7XHJcbiAgICAgIHRleHQ6IFwiT2NjdXJlbmNlIGxhYmVsc1wiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgZm9yIChcclxuICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICBpIDwgT2JqZWN0LmtleXModGhpcy5wbHVnaW4uc2V0dGluZ3Mub2NjdXJyZW5jZVR5cGVzKS5sZW5ndGg7XHJcbiAgICAgIGkrK1xyXG4gICAgKSB7XHJcbiAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgIC5zZXROYW1lKFxyXG4gICAgICAgICAgJ1dvdWxkIHlvdSBsaWtlIHRvIHJlbmFtZSBcIicgK1xyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWwgK1xyXG4gICAgICAgICAgICAnXCI/J1xyXG4gICAgICAgIClcclxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG4gICAgICAgICAgdGV4dC5pbnB1dEVsLnR5cGUgPSBcInRleHRcIjtcclxuICAgICAgICAgIHRleHRcclxuICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKHRoaXMucGx1Z2luLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS5sYWJlbClcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9jY3VycmVuY2VUeXBlc1tpXS5sYWJlbClcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWwgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuYWRkRXh0cmFCdXR0b24oKGJ1dHRvbikgPT5cclxuICAgICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgICAuc2V0SWNvbihcInJlc2V0XCIpXHJcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiUmVzdG9yZSBkZWZhdWx0XCIpXHJcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWwgPVxyXG4gICAgICAgICAgICAgICAgREVGQVVMVF9TRVRUSU5HUy5vY2N1cnJlbmNlVHlwZXNbaV0ubGFiZWw7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXR0aW5ncyBmb3IgZXNjYXBlIGNoYXJhY3RlcnNcclxuXHJcbiAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHtcclxuICAgICAgdGV4dDogXCJTcGVjaWFsIGNoYXJhY3RlcnNcIixcclxuICAgIH0pO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIkNvbXBsZXRlZCB0YXNrXCIpXHJcbiAgICAgIC5zZXREZXNjKFxyXG4gICAgICAgIFwiVGhpcyBjaGFyYWN0ZXIgaXMgdXNlZCBhcyBwcmVmaXggZm9yIGNvbXBsZXRlZCB0YXNrcyBpbiB0aGUgZGFpbHkgbm90ZVwiXHJcbiAgICAgIClcclxuICAgICAgLmFkZFRleHQoKHRleHQpID0+XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwie1wiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbXBsZXRlZFRhc2tDaGFyYWN0ZXIpXHJcbiAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29tcGxldGVkVGFza0NoYXJhY3RlciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEljb24oXCJyZXNldFwiKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29tcGxldGVkVGFza0NoYXJhY3RlciA9XHJcbiAgICAgICAgICAgICAgREVGQVVMVF9TRVRUSU5HUy5jb21wbGV0ZWRUYXNrQ2hhcmFjdGVyO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApO1xyXG5cclxuICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAuc2V0TmFtZShcIlN0YXJ0IG9mIG1ldGFkYXRhXCIpXHJcbiAgICAgIC5zZXREZXNjKFwiVGhpcyBjaGFyYWN0ZXIgc2hvd3MgdGhlIHN0YXJ0IG9mIHRoZSByZXdhcmQncyBkYXRhXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgIHRleHRcclxuICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIntcIilcclxuICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJCZWdpbilcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJCZWdpbiA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KVxyXG4gICAgICApXHJcbiAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEljb24oXCJyZXNldFwiKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyQmVnaW4gPVxyXG4gICAgICAgICAgICAgIERFRkFVTFRfU0VUVElOR1MuZXNjYXBlQ2hhcmFjdGVyQmVnaW47XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICB0aGlzLmRpc3BsYXkoKTtcclxuICAgICAgICAgIH0pXHJcbiAgICAgICk7XHJcbiAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgLnNldE5hbWUoXCJFbmQgb2YgbWV0YWRhdGFcIilcclxuICAgICAgLnNldERlc2MoXCJUaGlzIGNoYXJhY3RlciBzaG93cyB0aGUgZW5kIG9mIHRoZSByZXdhcmQncyBkYXRhXCIpXHJcbiAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcbiAgICAgICAgdGV4dFxyXG4gICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwifVwiKVxyXG4gICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVzY2FwZUNoYXJhY3RlckVuZClcclxuICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lc2NhcGVDaGFyYWN0ZXJFbmQgPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5hZGRFeHRyYUJ1dHRvbigoYnV0dG9uKSA9PlxyXG4gICAgICAgIGJ1dHRvblxyXG4gICAgICAgICAgLnNldEljb24oXCJyZXNldFwiKVxyXG4gICAgICAgICAgLnNldFRvb2x0aXAoXCJSZXN0b3JlIGRlZmF1bHRcIilcclxuICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZXNjYXBlQ2hhcmFjdGVyRW5kID1cclxuICAgICAgICAgICAgICBERUZBVUxUX1NFVFRJTkdTLmVzY2FwZUNoYXJhY3RlckVuZDtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuZGlzcGxheSgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgKTtcclxuICB9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUVBLFdBQU8sZUFBZSxTQUFTLGNBQWMsRUFBRSxPQUFPLEtBQUssQ0FBQztBQUU1RCxRQUFJLFdBQVcsUUFBUSxVQUFVO0FBRWpDLFFBQU0sNEJBQTRCO0FBQ2xDLFFBQU0sNkJBQTZCO0FBQ25DLFFBQU0sOEJBQThCO0FBQ3BDLFFBQU0sZ0NBQWdDO0FBQ3RDLFFBQU0sNkJBQTZCO0FBRW5DLGFBQVMsK0JBQStCLGFBQWE7QUFackQ7QUFjSSxZQUFNLGdCQUFnQixPQUFPLElBQUksUUFBUSxV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O0FBQUEsTUFDRixDQUFDO0FBQUEsSUFDSCxPQUFPO0FBQ0wsWUFBTSxTQUFTLE1BQU07QUFBQSxRQUNuQixNQUFNO0FBQUEsTUFDUixDQUFDO0FBQ0QsWUFBTSxTQUFTLEtBQUs7QUFBQSxRQUNsQixNQUFNO0FBQUEsTUFDUixDQUFDO0FBQ0QsWUFBTSxTQUFTLE1BQU07QUFBQSxRQUNuQixNQUFNLFlBQU8sS0FBSyxhQUFhLGFBQWE7QUFBQSxRQUM1QyxLQUFLO0FBQUEsTUFDUCxDQUFDO0FBQ0QsWUFBTSxTQUFTLE9BQU87QUFBQSxRQUNwQixNQUFNO0FBQUEsVUFDSixLQUFLLEtBQUssYUFBYTtBQUFBLFFBQ3pCO0FBQUEsTUFDRixDQUFDO0FBQ0QsWUFBTSxTQUFTLE1BQU07QUFBQSxRQUNuQixNQUFNO0FBQUEsTUFDUixDQUFDO0FBQ0QsWUFDRyxTQUFTLFVBQVU7QUFBQSxRQUNsQixNQUFNLEVBQUUsTUFBTSxTQUFTO0FBQUEsUUFDdkIsTUFBTTtBQUFBLE1BQ1IsQ0FBQyxFQUNBLGlCQUFpQixTQUFTLE1BQU07QUFDL0IsYUFBSyxXQUFXO0FBQ2hCLGFBQUssTUFBTTtBQUFBLE1BQ2IsQ0FBQztBQUFBLElBQ0w7QUFBQSxFQUNGO0FBQUEsRUFFQSxVQUFVO0FBQ1IsVUFBTSxFQUFFLFVBQVUsSUFBSTtBQUN0QixjQUFVLE1BQU07QUFBQSxFQUNsQjtBQUNGOyIsCiAgIm5hbWVzIjogWyJmb3JtYXQiLCAiZm9sZGVyIiwgInRlbXBsYXRlIiwgImNyZWF0ZURhaWx5Tm90ZSIsICJhcHAiLCAibW9tZW50IiwgImdldERhaWx5Tm90ZSIsICJnZXRBbGxEYWlseU5vdGVzIiwgImFwcEhhc0RhaWx5Tm90ZXNQbHVnaW5Mb2FkZWQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbl9kYWlseV9ub3Rlc19pbnRlcmZhY2UiLCAiYXBwIiwgInRleHQiLCAiaSIsICJhcHAiXQp9Cg==
